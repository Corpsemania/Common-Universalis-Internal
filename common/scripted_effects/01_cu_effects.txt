########################################Notes From Common Universalis Team###########################################
#In Common Universalis, scripted effects are used as functions ( like those in programming ) to make modding more standardized and the scripts easier to read.
#CU functions mostly use cu_var1, cu_var2 and cu_var3 as parameters passed from or to other functions. 
#These three variable are also used to store temperorary values. Do not use them to save long-time datas as they are likely to be changed by other functions. 
#We suggest sub-modders to use these functions for maximum compatibility.
#Sub-modders should not change these functions. Create your own functions if default ones do not suit your need.
#Good luck!
#Maximus
#5/8/2018
#####################################################################################################################

#Variable List

#Generic variable:
#cu_var1: Generic first variable for the following function
#cu_var2: Generic second variable
#cu_var3: Generic third variable
#The three variables listed above are used as parameters passed between functions. It is suggested for all functions to give initial values to them unless they are passed from other functions, and set them to 0 at the end of the function.

#Common Variables
#p_dev: Province Development


### Public ###

#cu_country_census[] #Calculate and set country statistics
cu_country_census = {
       country_event = { id = cugovernment.1 } #Refresh GC
       set_variable = { which = num_pp value = 0 } #Num of provinces
	   set_variable = { which = num_ps value = 0 } #Num of State Provinces
	   set_variable = { which = tt_literacy value = 0 } #Total Literacy
	   set_variable = { which = tv_literacy value = 0 } #Total Average Literacy
	   set_variable = { which = t_literacy value = 0 } #Total State Literacy
	   set_variable = { which = ave_literacy value = 0 } #Average State Literacy
	   set_variable = { which = t_merc value = 0 } #Total Commercial Power
	   set_variable = { which = t_indu value = 0 } #Total Industrial Power 
	   set_variable = { which = t_agri value = 0 } #Total Agricultural Power 
	   set_variable = { which = t_pop value = 0 } #Total Population(Estimated, display only)
	   set_variable = { which = tp_pop value = 0 } #Primary Ethnic Population(Estimated, display only)
	   set_variable = { which = t_dev value = 0 } #Total Development
	   set_variable = { which = tp_dev value = 0 } #Primary Ethnic Development
        every_owned_province = {
	          limit = { is_colony = no }
			  
			  cu_calc_pop_c_disp = yes
			  set_variable = { which = p_dev value = 0 }
			  export_to_variable = {
			        which = p_dev
					value = development
			  }
			  owner = { 
			           change_variable = { which = num_pp value = 1 }
			           set_variable = { which = literacy which = PREV }
                       divide_variable = { which = literacy value = 100 }					   
					   change_variable = { which = tt_literacy which = literacy }
					   set_variable = { which = merc_c which = PREV }
					   change_variable = { which = t_merc which = merc_c }
					   set_variable = { which = indu_c which = PREV }
					   change_variable = { which = t_indu which = indu_c }
					   set_variable = { which = o_ac which = PREV }
					   change_variable = { which = t_agri which = o_ac }
					   set_variable = { which = p_pop which = PREV }
					   set_variable = { which = p_dev which = PREV }
					   change_variable = { which = t_pop which = p_pop  }
					   change_variable = { which = t_dev which = p_dev }
			  }
			  if = {
			        limit = { cu_not_terr_trigger = yes }
					owner = {
					    change_variable = { which = num_ps value = 1 }
					    change_variable = { which = t_literacy which = literacy }
					}
			  }
			  if = {
			         limit = {
					         OR = {
							        has_owner_culture = yes
									AND = {
									      owner = { culture_group = PREV }
										  OR = {
										        owner = { government_rank = 3 }
												has_owner_accepted_culture = yes
										  }
									}
							 }
					 }
					 owner = {
					    change_variable = { which = tp_pop which = p_pop  }
					    change_variable = { which = tp_dev which = p_dev }
					}
			  }
			  cu_show_cultural_acceptance = yes
	    }
		
	    if = {
			        limit = { NOT = { check_variable = { which = num_pp value = 1 } } }
					set_variable = { which = num_pp value = 1 }
	    }
		
	    if = {
			        limit = { NOT = { check_variable = { which = num_ps value = 1 } } }
					set_variable = { which = num_ps value = 1 }
		}
		
		set_variable = { which = tv_literacy which = tt_literacy }
		divide_variable = { which = tv_literacy which = num_pp }
		multiply_variable = { which = tv_literacy value = 100 }
		
		set_variable = { which = ave_literacy which = t_literacy }
		divide_variable = { which = ave_literacy which = num_ps }
		multiply_variable = { which = ave_literacy value = 100 }
		
       	cu_display_cultural_power = yes  
		set_country_flag = cu_stability_fixed
		cu_calc_total_stability_growth = yes
		clr_country_flag = cu_stability_fixed
		cu_calc_allowed_road_level_country = yes
}

#cu_change_stability[cu_var1]
cu_change_stability = {
  hidden_effect = {
    if = {
	      limit = { check_variable = { which = cu_var1 value = 1 } }
		  while = {
	         limit = {
			    NOT = { has_country_flag = cu_stability_fixed }
		        check_variable = { which = cu_var1 value = 1 }
		     }
		     if = {
			      limit = { NOT = { stability = 3 } }
				  add_stability = 1
				  
			 }
			 else = {
			      add_adm_power = 100
			 }
		     change_variable = { which = cu_var1 value = -1 }
	      }
	}
	else = {
	     while = {
	         limit = {
			    NOT = { has_country_flag = cu_stability_fixed }
		        NOT = { check_variable = { which = cu_var1 value = 0 } }
		     }
			 if = {
			        limit = {
					     full_idea_group = diplomatic_ideas
					}
					add_adm_power = -50
			 }
		     else_if = {
			      limit = { stability = -2 }
				  add_stability = -1
			 }
			 else = {
			      add_adm_power = -200
			 }
		     change_variable = { which = cu_var1 value = 1 }
	      } 
	}
	set_variable = { which = cu_var1 value = 0 }
  }
}
#cu_add_base_commerce[cu_var1]
cu_add_base_commerce = {
    while = {
	      limit = {
		        check_variable = { which = cu_var1 value = 1 }
		  }
		  add_base_tax = 1
		  subtract_variable = { which = cu_var1 value = 1 }
	}
	while = {
	      limit = {
		        NOT = { check_variable = { which = cu_var1 value = -1 } }
		  }
		  add_base_tax = -1
		  change_variable = { which = cu_var1 value = 1 }
	}
	set_variable = { which = cu_var1 value = 0 }
	
	#Scripted Effects
	
	#End
}

#cu_add_base_production[cu_var1]
cu_add_base_production = {
    while = {
	      limit = {
		        check_variable = { which = cu_var1 value = 1 }
		  }
		  add_base_production = 1
		  subtract_variable = { which = cu_var1 value = 1 }
	}
	while = {
	      limit = {
		        NOT = { check_variable = { which = cu_var1 value = -1 } }
		  }
		  add_base_production = -1
		  change_variable = { which = cu_var1 value = 1 }
	}
	set_variable = { which = cu_var1 value = 0 }
	
	#Scripted Effects
	
	#End
}

#cu_add_base_agriculture[cu_var1]
cu_add_base_agriculture = {
    while = {
	      limit = {
		        check_variable = { which = cu_var1 value = 1 }
		  }
		  add_base_manpower = 1
		  subtract_variable = { which = cu_var1 value = 1 }
	}
	while = {
	      limit = {
		        NOT = { check_variable = { which = cu_var1 value = -1 } }
		  }
		  add_base_manpower = -1
		  change_variable = { which = cu_var1 value = 1 }
	}
	set_variable = { which = cu_var1 value = 0 }
	
	#Scripted Effects
	
	#End
}

cu_check_ruler_ra_mil = {
    if = {
	      limit = { 
                   check_variable = { which = cu_ra_w value = 4 }
				   NOT = { mil = 6 }
		  }
          country_event = { id = curuler.1 }
          subtract_variable = { which = cu_ra_w value = -4 }		  
	}
	
	if = {
	      limit = { 
                   check_variable = { which = cu_ra_w value = 8 }
				   mil = 6
				   NOT = { has_ruler_flag = the_great_conqueror }
		  }
          country_event = { id = curuler.2 }
          subtract_variable = { which = cu_ra_w value = -8 }		  
	}
	if = { #Calculate Nomad Ruler GC
		        limit = { 
                          OR = {
						         government = tribal
								 has_reform =  steppe_horde
								 has_reform =  steppe_empire
								 primitives = yes
						  }
				}
				
		set_variable = { which = ruler_gc which = cu_ra_ws }
	    multiply_variable = { which = ruler_gc value = 8 }
		
    }
	set_variable = { which = cu_ra_wsd which = cu_ra_ws }
	multiply_variable = { which = cu_ra_wsd value = 100 }
}

cu_reduce_base_tax_1 = {
    add_base_tax = -1
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_reduce_base_tax_2 = {
    add_base_tax = -2
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_reduce_base_tax_3 = {
    add_base_tax = -3
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_reduce_base_tax_4 = {
    add_base_tax = -4
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_reduce_base_tax_5 = {
    add_base_tax = -5
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_add_base_tax_1 = {
    add_base_tax = 1
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_add_base_tax_2 = {
    add_base_tax = 2
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_add_base_tax_3 = {
    add_base_tax = 3
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_add_base_tax_4 = {
    add_base_tax = 4
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_add_base_tax_5 = {
    add_base_tax = 5
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_reduce_base_production_1 = {
    add_base_production = -1
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_reduce_base_production_2 = {
    add_base_production = -2
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_reduce_base_production_3 = {
    add_base_production = -3
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_reduce_base_production_4 = {
    add_base_production = -4
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_reduce_base_production_5 = {
    add_base_production = -5
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_add_base_production_1 = {
    add_base_production = 1
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_add_base_production_2 = {
    add_base_production = 2
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_add_base_production_3 = {
    add_base_production = 3
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_add_base_production_4 = {
    add_base_production = 4
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_add_base_production_5 = {
    add_base_production = 5
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_reduce_base_manpower_1 = {
    add_base_manpower = -1
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_reduce_base_manpower_2 = {
    add_base_manpower = -2
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_reduce_base_manpower_3 = {
    add_base_manpower = -3
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_reduce_base_manpower_4 = {
    add_base_manpower = -4
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_reduce_base_manpower_5 = {
    add_base_manpower = -5
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_add_base_manpower_1 = {
    add_base_manpower = 1
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_add_base_manpower_2 = {
    add_base_manpower = 2
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_add_base_manpower_3 = {
    add_base_manpower = 3
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_add_base_manpower_4 = {
    add_base_manpower = 4
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

cu_add_base_manpower_5 = {
    add_base_manpower = 5
	#set_province_flag = culture_gcheck
	#cu_check_cultural_acceptance = yes
}

refresh_province_data = {
    add_province_modifier = {
	       name = province_refresher
		   duration = 1
	}
	remove_province_modifier = province_refresher
}


cu_province_initialization = {
	set_variable = { which = cu_var1 value = 0 } #Generic Variable 1
	set_variable = { which = cu_var2 value = 0 } #Generic Variable 2
	set_variable = { which = cu_var3 value = 0 } #Generic Variable 3
	set_variable = { which = literacy value = 0 } #Literacy
	set_variable = { which = pop_prog value = 0 } #Population Growth Progress
	set_variable = { which = merc_prog value = 0 } #Commerce Growth Progress
	set_variable = { which = indu_prog value = 0 } #Production Growth Progress
	set_variable = { which = b_ac value = 0 } #Base Agriculture Capacity
	set_variable = { which = b_uc value = 0 } #Base Urbanization Capacity
	set_variable = { which = p_ca value = 0 } #Cultural Acceptance
	set_variable = { which = p_cad value = 0 } #Dynamic Cultural Acceptance
	set_variable = { which = p_nationalism value = 0 } #Nationalism
	set_variable = { which = p_nationalism_g value = 0 } #Nationalism Yearly Growth
	set_variable = { which = p_as value = 0 }
	set_variable = { which = p_asc value = 10 }
	#Initialize Art Values
	set_variable = { which = cu_art_slot value = 0 }
	set_variable = { which = cu_art_power value = 0 }
	set_variable = { which = cu_art_power_wonder value = 0 }
	set_variable = { which = art_power_c value = 0 }
	set_variable = { which = cu_art_piece value = 0 }
	set_variable = { which = cu_art_piece0 value = 0 }
	set_variable = { which = cu_art_piece1 value = 0 }
	set_variable = { which = cu_art_piece2 value = 0 }
	set_variable = { which = cu_theatre value = 0 }
	set_variable = { which = cu_salon value = 0 }
	set_variable = { which = cu_museum_level value = 1 } #1 Means this number is properly initialized, no museum actually.
	set_variable = { which = art_level value = 0 }
	set_variable = { which = ep_dev value = 0 }
	
	#Turkish Egypt
	if = {
		limit = {
			AND = {
				is_core = TUR
				owned_by = TUR
				culture = al_misr_arabic
				}
		}
		add_local_autonomy = 20
		add_province_modifier = {
				name = mamluks_corruption
				duration = -1
		}
		if = {
				limit = { is_year = 1600 }
				add_local_autonomy = 20
		}
	}
	if = {
		limit = { is_empty = no }
		set_variable = { which = literacy value = 1 } #Initial Literacy
		if = {
			limit = {
				owner = {
					NOT = { has_institution = fedualism }
					capital_scope = {
						OR = {
							continent = oceania
							continent = south_america
							continent = north_america
							continent = new_world
						}
					}
				}
			}
			change_variable = { which = literacy value = -0.5 }
		}
	}
	#1444 Start
    if = {
		limit = { has_global_flag = start_1444 }
		
		if = {
			limit = { is_empty = no }
			
			#Initialize Road
			set_variable = { which = cu_road_level value = 0 }
			if = {
				limit = { development = 15 }
				change_variable = { which = cu_road_level value = 2 }
			}
			else_if = {
				limit = { development = 6 }
				change_variable = { which = cu_road_level value = 1 }
			}
			if = { #Remnants of Ancient Roman Road
				limit = {
					OR = {
						area = provence_area
						area = home_counties_area
						area = thrace_area
						region = italy_region
					}
					development = 15
				}
				change_variable = { which = cu_road_level value = 1 }
			}
			else_if = { #Ancient Chinese Road
				limit = {
					OR = {
						region = south_china_region
						region = xinan_region
						region = north_china_region
					}
					OR = {
						fort_level = 2
						province_has_center_of_trade_of_level = 1
						development = 15
					}
				}
				change_variable = { which = cu_road_level value = 1 }
			}
			cu_update_road_level = yes
			#Road Complete
			
			if = {
				limit = { culture_group = dutch_g }
				change_variable = { which = literacy value = 3 }
			}
			else_if = {
				limit = { cu_germanic_group = yes }
				change_variable = { which = literacy value = 2 }
			}
			else_if = {
				limit = { culture_group = scandinavian }
				change_variable = { which = literacy value = 2 }
			}
			else_if = {
				limit = { culture_group = british }
				change_variable = { which = literacy value = 2 }
			}
			else_if = {
				limit = { 
							cu_gaelic_group = yes								 
				}
				change_variable = { which = literacy value = 1 }
			}
			else_if = {
				limit = { 
							culture_group = gallo_italic
				}
				change_variable = { which = literacy value = 3.2 }
				add_base_manpower = -1
				if = {
						limit = { base_production = 8 }
						add_base_production = -1
				}
			}
			else_if = {
				limit = { 
							culture_group = southern_french
				}
				change_variable = { which = literacy value = 1.5 }
			}
			else_if = {
				limit = { 
						culture_group = latin 											 
				}
				change_variable = { which = literacy value = 2.5 }
				if = {
					limit = { culture = tuscan }
					change_variable = { which = literacy value = 0.7 }
				}
			}
			else_if = {
				limit = { 
							culture_group = iberian 										 
				}
				change_variable = { which = literacy value = 2 }
			}
			else_if = {
				limit = { 
							culture_group = french										 
				}
				change_variable = { which = literacy value = 2 }
			}		
			else_if = {
			limit = { 
						culture_group = arpitan_g										 
			}
			change_variable = { which = literacy value = 1 }
			}						  
			else_if = {
				limit = { 
							cu_south_slavic_group = yes #Only use for making old codes stable										 
				}
				change_variable = { which = literacy value = 1 }
			}
			else_if = {
				limit = { 
				culture_group = caucasian										 
				}
				change_variable = { which = literacy value = 1 }
			}
			else_if = {
				limit = { 
							culture_group = hayani										 
				}
				change_variable = { which = literacy value = 1 }
			}
			else_if = {
				limit = { 
							culture_group = romanan									 
				}
				change_variable = { which = literacy value = 1 }
			}							  
			else_if = {
				limit = { 
							culture_group = basque_g							 
				}
				change_variable = { which = literacy value = 1 }
			}
			else_if = {
				limit = { 
							culture_group = west_slavic										 
				}
				change_variable = { which = literacy value = 2 }
			}		
			else_if = {
			limit = { 
						culture_group = cechitian										 
			}
			change_variable = { which = literacy value = 2 }
			}		
			else_if = {
			limit = { 
						culture_group = sorbian_g									 
			}
			change_variable = { which = literacy value = 2 }
			}				  
			else_if = {
				limit = { 
							culture_group = east_slavic								 
				}
				change_variable = { which = literacy value = 1 }
			}
			else_if = {
				limit = { 
							cu_baltic_group = yes							 
				}
				change_variable = { which = literacy value = 1 }
			}
			else_if = {
				limit = { 
							culture_group = byzantine						 
				}
				change_variable = { which = literacy value = 2 }
				if = {
					limit = { 
								culture = greek						 
					}
					change_variable = { which = literacy value = 0.2 }
				}
			}
			else_if = {
				limit = { 
							culture_group = west_turk_g			 
						NOT = { culture = turkmeni }														  
				}
				change_variable = { which = literacy value = 1.5 }
			}
			else_if = {
				limit = { 
							culture_group = turko_semitic						 
				}
				change_variable = { which = literacy value = 2 }
			}							  
			else_if = {
				limit = { 
							cu_iranian_group = yes					 
				}
				change_variable = { which = literacy value = 1 }
			}
			else_if = {
				limit = { 
							culture_group = east_asian					 
				}
				change_variable = { which = literacy value = 2 }
			}
			else_if = {
				limit = { 
					cu_minor_chinese_group = yes				 
				}
				change_variable = { which = literacy value = 1 }
			}
			else_if = {
				limit = { 
							culture_group = korean_g
				}
				change_variable = { which = literacy value = 1 }
			}
			else_if = {
				limit = { 
							culture = vietnamese					 
				}
				change_variable = { which = literacy value = 1 }
			}
			else_if = {
				limit = { 
							culture_group = japanese_g					 
				}
				change_variable = { which = literacy value = 1 }
			}
			else_if = {
				limit = { 
					cu_india_culture = yes				 
				}
				change_variable = { which = literacy value = 1 }
			}
			else_if = {
				limit = { 
							cu_cushitic_group = yes
				}
				change_variable = { which = literacy value = 1 }
			}
			else_if = {
				limit = { 
							culture_group = mande
				}
				change_variable = { which = literacy value = 1 }
			}
			else_if = {
				limit = { 
						culture_group = gothic
				}
				change_variable = { which = literacy value = 1 }
			}
			set_province_flag = literacy_init
		}
		set_variable = { which = lit_g value = 0 } #Literacy Growth
	}
            #1500 Start
            	if = {
                       limit = { has_global_flag = start_1500 }
                       
                            set_variable = { which = literacy value = 1 } #Literacy
					        if = {
							  limit = { is_empty = no }
							  
							  #Initialize Road
			set_variable = { which = cu_road_level value = 0 }
			if = {
				limit = { development = 18 }
				change_variable = { which = cu_road_level value = 3 }
			}
			else_if = {
				limit = { development = 12 }
				change_variable = { which = cu_road_level value = 2 }
			}
			else_if = {
				limit = { development = 6 }
				change_variable = { which = cu_road_level value = 1 }
			}
			if = { #Remnants of Ancient Roman Road
				limit = {
					OR = {
						area = provence_area
						area = home_counties_area
						area = thrace_area
						region = italy_region
					}
					development = 15
				}
				change_variable = { which = cu_road_level value = 1 }
			}
			else_if = { #Ancient Chinese Road
				limit = {
					OR = {
						region = south_china_region
						region = xinan_region
						region = north_china_region
					}
					OR = {
						fort_level = 2
						province_has_center_of_trade_of_level = 1
						development = 15
					}
				}
				change_variable = { which = cu_road_level value = 1 }
			}
			cu_update_road_level = yes
			#Road Complete
							  if = {
							        limit = { culture_group = dutch_g }
									change_variable = { which = literacy value = 4 }
							  }
							  else_if = {
							        limit = { cu_germanic_group = yes }
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { culture_group = scandinavian }
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { culture_group = british }
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         cu_gaelic_group = yes								 
									}
									change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = gallo_italic
									}
									change_variable = { which = literacy value = 4.2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = southern_french
									}
									change_variable = { which = literacy value = 2.5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = latin 									 
									}
									change_variable = { which = literacy value = 3.5 }
									if = {
										limit = { culture = tuscan }
										change_variable = { which = literacy value = 0.7 }
									}
							  }
							  else_if = {
							        limit = { 
									         culture_group = iberian 										 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = french										 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
								limit = { 
										 culture_group = arpitan_g										 
								}
								change_variable = { which = literacy value = 2 }
						  		}
							  else_if = {
							        limit = { 
									         culture_group = finno_ugric									 
									}
									change_variable = { which = literacy value = 1.5 }
							  }
							  else_if = {
							        limit = { 
									         cu_south_slavic_group = yes #Only use for making old codes stable										 
									}
									change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = romanan									 
									}
									change_variable = { which = literacy value = 2 }
							  }
							  
							  else_if = {
							        limit = { 
									         culture_group = basque_g							 
									}
									change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = west_slavic										 
									}
									change_variable = { which = literacy value = 3 }
							  }			
							  else_if = {
								limit = { 
										 culture_group = cechitian										 
								}
								change_variable = { which = literacy value = 3 }
							  }		
							  else_if = {
								limit = { 
										 culture_group = sorbian_g									 
								}
								change_variable = { which = literacy value = 3 }
						 	  }						  
							  else_if = {
							        limit = { 
									         culture_group = east_slavic								 
									}
									change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         cu_baltic_group = yes							 
									}
									change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = byzantine						 
									}
									change_variable = { which = literacy value = 4 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = west_turk_g			 
									}
									change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = pontic_greek						 
									}
									change_variable = { which = literacy value = 1.5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = turko_semitic						 
									}
									change_variable = { which = literacy value = 3 }
							  }							  
							  else_if = {
							        limit = { 
									         cu_iranian_group = yes					 
									}
									change_variable = { which = literacy value = 1.5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = east_asian					 
									}
									change_variable = { which = literacy value = 2.5 }
							  }
							  else_if = {
								limit = { 
									cu_minor_chinese_group = yes				 
								}
								change_variable = { which = literacy value = 1 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = korean_g
									}
									change_variable = { which = literacy value = 1 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = japanese_g					 
									}
									change_variable = { which = literacy value = 1 }
							  }
							  else_if = {
							        limit = { 
										cu_india_culture = yes			 
									}
									change_variable = { which = literacy value = 1 }
							  }
							  
							  else_if = {
							        limit = { 
									         culture_group = mande
									}
									change_variable = { which = literacy value = 1 }
							  }
							  else_if = {
								limit = { 
										culture_group = gothic
								}
								change_variable = { which = literacy value = 1 }
							 }
							  set_province_flag = literacy_init
						}
						set_variable = { which = lit_g value = 0 } #Literacy Growth
						
                 } 

                 #1550 Start
                 if = {
                       limit = { has_global_flag = start_1550 }
                       
                            set_variable = { which = literacy value = 1 } #Literacy
					        if = {
							  limit = { is_empty = no }
							  
								#Initialize Road
								set_variable = { which = cu_road_level value = 0 }
								if = {
									limit = { development = 15 }
									change_variable = { which = cu_road_level value = 3 }
								}
								else_if = {
									limit = { development = 10 }
									change_variable = { which = cu_road_level value = 2 }
								}
								else_if = {
									limit = { development = 6 }
									change_variable = { which = cu_road_level value = 1 }
								}
								if = { #Remnants of Ancient Roman Road
									limit = {
										OR = {
											area = provence_area
											area = home_counties_area
											area = thrace_area
											region = italy_region
										}
										development = 15
										NOT = { check_variable = { which = cu_road_level value = 3 } }
									}
									change_variable = { which = cu_road_level value = 1 }
								}
								else_if = { #Ancient Chinese Road
									limit = {
										OR = {
											region = south_china_region
											region = xinan_region
											region = north_china_region
										}
										OR = {
											fort_level = 2
											province_has_center_of_trade_of_level = 1
											development = 15
										}
										NOT = { check_variable = { which = cu_road_level value = 3 } }
									}
									change_variable = { which = cu_road_level value = 1 }
								}
								cu_update_road_level = yes
								#Road Complete
							  
							  if = {
							        limit = { culture_group = dutch_g }
									change_variable = { which = literacy value = 6 }
							  }
							  else_if = {
							        limit = { cu_germanic_group = yes }
									change_variable = { which = literacy value = 6 }
							  }
							  else_if = {
							        limit = { culture_group = scandinavian }
									change_variable = { which = literacy value = 5 }
							  }
							  else_if = {
							        limit = { culture_group = british }
									change_variable = { which = literacy value = 5 }
							  }
							  else_if = {
							        limit = { 
									         cu_gaelic_group = yes								 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = gallo_italic
									}
									change_variable = { which = literacy value = 5.5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = southern_french
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = latin 										 
									}
									change_variable = { which = literacy value = 4 }
									if = {
										limit = { culture = tuscan }
										change_variable = { which = literacy value = 1 }
									}
							  }
							  else_if = {
							        limit = { 
									         culture_group = iberian 										 
									}
									change_variable = { which = literacy value = 4 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = french										 
									}
									change_variable = { which = literacy value = 4.5 }
							  }
							  else_if = {
								limit = { 
										 culture_group = arpitan_g										 
								}
								change_variable = { which = literacy value = 2.5 }
						  		}
							  else_if = {
							        limit = { 
									         culture_group = finno_ugric									 
									}
									change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         cu_south_slavic_group = yes #Only use for making old codes stable										 
									}
									change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = romanan									 
									}
									change_variable = { which = literacy value = 2 }
							  }
							  
							  else_if = {
							        limit = { 
									         culture_group = basque_g							 
									}
									change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = west_slavic										 
									}
									change_variable = { which = literacy value = 2 }
							  }						
							  else_if = {
								limit = { 
										 culture_group = cechitian										 
								}
								change_variable = { which = literacy value = 2 }
							  }		
							  else_if = {
								limit = { 
										 culture_group = sorbian_g									 
								}
								change_variable = { which = literacy value = 2 }
						 	  }			 
							  else_if = {
							        limit = { 
									         culture_group = east_slavic								 
									}
									change_variable = { which = literacy value = 2.5 }
							  }
							  else_if = {
							        limit = { 
									         cu_baltic_group = yes							 
									}
									change_variable = { which = literacy value = 2.5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = byzantine						 
									}
									change_variable = { which = literacy value = 4 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = west_turk_g			 
									}
									change_variable = { which = literacy value = 2.5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = pontic_greek						 
									}
									change_variable = { which = literacy value = 1.5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = turko_semitic						 
									}
									change_variable = { which = literacy value = 4 }
							  }							  
							  else_if = {
							        limit = { 
									         cu_iranian_group = yes					 
									}
									change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = east_asian					 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
								limit = { 
									cu_minor_chinese_group = yes				 
								}
								change_variable = { which = literacy value = 1.5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = korean_g
									}
									change_variable = { which = literacy value = 1.5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = japanese_g					 
									}
									change_variable = { which = literacy value = 1.5 }
							  }
							  else_if = {
							        limit = { 
									    cu_india_culture = yes		 
									}
									change_variable = { which = literacy value = 1 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = mande
									}
									change_variable = { which = literacy value = 1 }
							  }
							  else_if = {
								limit = { 
										culture_group = gothic
								}
								change_variable = { which = literacy value = 1 }
							 }
							  set_province_flag = literacy_init
						}
						set_variable = { which = lit_g value = 0 } #Literacy Growth
                 } 

                 #1600 Start
                 if = {
                       limit = { has_global_flag = start_1600 }
                       
                            set_variable = { which = literacy value = 1 } #Literacy
					        if = {
							  limit = { is_empty = no }
							  
							  #Initialize Road
								set_variable = { which = cu_road_level value = 0 }
								if = {
									limit = { development = 18 }
									change_variable = { which = cu_road_level value = 4 }
								}
								else_if = {
									limit = { development = 10 }
									change_variable = { which = cu_road_level value = 3 }
								}
								else_if = {
									limit = { development = 8 }
									change_variable = { which = cu_road_level value = 2 }
								}
								else_if = {
									limit = { development = 6 }
									change_variable = { which = cu_road_level value = 1 }
								}
								if = { #Remnants of Ancient Roman Road
									limit = {
										OR = {
											area = provence_area
											area = home_counties_area
											area = thrace_area
											region = italy_region
										}
										development = 15
										NOT = { check_variable = { which = cu_road_level value = 3 } }
									}
									change_variable = { which = cu_road_level value = 1 }
								}
								else_if = { #Ancient Chinese Road
									limit = {
										OR = {
											region = south_china_region
											region = xinan_region
											region = north_china_region
										}
										OR = {
											fort_level = 2
											province_has_center_of_trade_of_level = 1
											development = 15
										}
										NOT = { check_variable = { which = cu_road_level value = 3 } }
									}
									change_variable = { which = cu_road_level value = 1 }
								}
								cu_update_road_level = yes
								#Road Complete
								
							  if = {
							        limit = { culture_group = dutch_g }
									change_variable = { which = literacy value = 9 }
							  }
							  else_if = {
							        limit = { cu_germanic_group = yes }
									change_variable = { which = literacy value = 8 }
							  }
							  else_if = {
							        limit = { culture_group = scandinavian }
									change_variable = { which = literacy value = 7 }
							  }
							  else_if = {
							        limit = { culture_group = british }
									change_variable = { which = literacy value = 8 }
							  }
							  else_if = {
							        limit = { 
									         cu_gaelic_group = yes								 
									}
									change_variable = { which = literacy value = 5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = gallo_italic
									}
									change_variable = { which = literacy value = 7.5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = southern_french
									}
									change_variable = { which = literacy value = 7 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = latin 											 
									}
									change_variable = { which = literacy value = 6 }
									if = {
										limit = { culture = tuscan }
										change_variable = { which = literacy value = 1 }
									}
							  }
							  else_if = {
							        limit = { 
									         culture_group = iberian 										 
									}
									change_variable = { which = literacy value = 6 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = french										 
									}
									change_variable = { which = literacy value = 8 }
							  }
							  else_if = {
								limit = { 
										 culture_group = arpitan_g										 
								}
								change_variable = { which = literacy value = 6.5 }
						  		}
							  else_if = {
							        limit = { 
									         culture_group = finno_ugric									 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         cu_south_slavic_group = yes #Only use for making old codes stable										 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = romanan									 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  
							  else_if = {
							        limit = { 
									         culture_group = basque_g							 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = west_slavic										 
									}
									change_variable = { which = literacy value = 7 }
							  }							  
							  else_if = {
								limit = { 
										 culture_group = cechitian										 
								}
								change_variable = { which = literacy value = 7 }
							  }		
							  else_if = {
								limit = { 
										 culture_group = sorbian_g									 
								}
								change_variable = { which = literacy value = 7 }
						 	  }		
							  else_if = {
							        limit = { 
									         culture_group = east_slavic								 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         cu_baltic_group = yes							 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = byzantine						 
									}
									change_variable = { which = literacy value = 5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = west_turk_g			 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = pontic_greek						 
									}
									change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = turko_semitic						 
									}
									change_variable = { which = literacy value = 5 }
							  }							  
							  else_if = {
							        limit = { 
									         cu_iranian_group = yes					 
									}
									change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = east_asian					 
									}
									change_variable = { which = literacy value = 4 }
							  }
							  else_if = {
								limit = { 
									cu_minor_chinese_group = yes				 
								}
								change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = korean_g
									}
									change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = japanese_g					 
									}
									change_variable = { which = literacy value = 2.5 }
							  }
							  else_if = {
							        limit = { 
										cu_india_culture = yes        				 
									}
									change_variable = { which = literacy value = 1 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = mande
									}
									change_variable = { which = literacy value = 1 }
							  }
							  else_if = {
								limit = { 
										culture_group = gothic
								}
								change_variable = { which = literacy value = 2 }
							 }
							  set_province_flag = literacy_init
						}
						set_variable = { which = lit_g value = 0 } #Literacy Growth
						
                 } 

                 #1650 Start
                 if = {
                       limit = { has_global_flag = start_1650 }
                       
                            set_variable = { which = literacy value = 1 } #Literacy
					        if = {
							  limit = { is_empty = no }
							  
							  #Initialize Road
								set_variable = { which = cu_road_level value = 0 }
								if = {
									limit = { development = 22 }
									change_variable = { which = cu_road_level value = 5 }
								}
								else_if = {
									limit = { development = 16 }
									change_variable = { which = cu_road_level value = 4 }
								}
								else_if = {
									limit = { development = 10 }
									change_variable = { which = cu_road_level value = 3 }
								}
								else_if = {
									limit = { development = 8 }
									change_variable = { which = cu_road_level value = 2 }
								}
								else_if = {
									limit = { development = 6 }
									change_variable = { which = cu_road_level value = 1 }
								}
								if = { #Remnants of Ancient Roman Road
									limit = {
										OR = {
											area = provence_area
											area = home_counties_area
											area = thrace_area
											region = italy_region
										}
										development = 15
										NOT = { check_variable = { which = cu_road_level value = 3 } }
									}
									change_variable = { which = cu_road_level value = 1 }
								}
								else_if = { #Ancient Chinese Road
									limit = {
										OR = {
											region = south_china_region
											region = xinan_region
											region = north_china_region
										}
										OR = {
											fort_level = 2
											province_has_center_of_trade_of_level = 1
											development = 15
										}
										NOT = { check_variable = { which = cu_road_level value = 3 } }
									}
									change_variable = { which = cu_road_level value = 1 }
								}
								cu_update_road_level = yes
								#Road Complete
							  if = {
							        limit = { culture_group = dutch_g }
									change_variable = { which = literacy value = 14 }
							  }
							  else_if = {
							        limit = { cu_germanic_group = yes }
									change_variable = { which = literacy value = 10 }
							  }
							  else_if = {
							        limit = { culture_group = scandinavian }
									change_variable = { which = literacy value = 12 }
							  }
							  else_if = {
							        limit = { culture_group = british }
									change_variable = { which = literacy value = 14 }
							  }
							  else_if = {
							        limit = { 
									         cu_gaelic_group = yes								 
									}
									change_variable = { which = literacy value = 7 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = gallo_italic
									}
									change_variable = { which = literacy value = 10.5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = southern_french
									}
									change_variable = { which = literacy value = 12 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = latin 											 
									}
									change_variable = { which = literacy value = 7 }
									if = {
										limit = { culture = tuscan }
										change_variable = { which = literacy value = 1.5 }
									}
							  }
							  else_if = {
							        limit = { 
									         culture_group = iberian 										 
									}
									change_variable = { which = literacy value = 9 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = french										 
									}
									change_variable = { which = literacy value = 16 }
							  }
							  else_if = {
								limit = { 
										 culture_group = arpitan_g										 
								}
								change_variable = { which = literacy value = 11 }
						  		}
							  else_if = {
							        limit = { 
									         culture_group = finno_ugric									 
									}
									change_variable = { which = literacy value = 5 }
							  }
							  else_if = {
							        limit = { 
									         cu_south_slavic_group = yes #Only use for making old codes stable										 
									}
									change_variable = { which = literacy value = 6 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = romanan									 
									}
									change_variable = { which = literacy value = 5 }
							  }
							  
							  else_if = {
							        limit = { 
									         culture_group = basque_g							 
									}
									change_variable = { which = literacy value = 5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = west_slavic										 
									}
									change_variable = { which = literacy value = 9 }
							  }							  
							  else_if = {
								limit = { 
										 culture_group = cechitian										 
								}
								change_variable = { which = literacy value = 9 }
							  }		
							  else_if = {
								limit = { 
										 culture_group = sorbian_g									 
								}
								change_variable = { which = literacy value = 9 }
						 	  }		
							  else_if = {
							        limit = { 
									         culture_group = east_slavic								 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         cu_baltic_group = yes							 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = byzantine						 
									}
									change_variable = { which = literacy value = 6 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = west_turk_g			 
									}
									change_variable = { which = literacy value = 4 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = pontic_greek						 
									}
									change_variable = { which = literacy value = 4 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = turko_semitic						 
									}
									change_variable = { which = literacy value = 6 }
							  }							  
							  else_if = {
							        limit = { 
									         cu_iranian_group = yes					 
									}
									change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = east_asian					 
									}
									change_variable = { which = literacy value = 4 }
							  }
							  else_if = {
								limit = { 
									cu_minor_chinese_group = yes				 
								}
								change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = korean_g
									}
									change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = japanese_g					 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									    cu_india_culture = yes			 
									}
									change_variable = { which = literacy value = 1 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = mande
									}
									change_variable = { which = literacy value = 1 }
							  }
							  else_if = {
								limit = { 
										culture_group = gothic
								}
								change_variable = { which = literacy value = 2 }
							 }
							  set_province_flag = literacy_init
						}
						set_variable = { which = lit_g value = 0 } #Literacy Growth
				
                 } 

                 #1700 Start
                 if = {
                       limit = { has_global_flag = start_1700 }
                       
                            set_variable = { which = literacy value = 1 } #Literacy
					        if = {
							  limit = { is_empty = no }
							  #Initialize Road
								set_variable = { which = cu_road_level value = 0 }
								if = {
									limit = { development = 22 }
									change_variable = { which = cu_road_level value = 5 }
								}
								else_if = {
									limit = { development = 16 }
									change_variable = { which = cu_road_level value = 4 }
								}
								else_if = {
									limit = { development = 10 }
									change_variable = { which = cu_road_level value = 3 }
								}
								else_if = {
									limit = { development = 8 }
									change_variable = { which = cu_road_level value = 2 }
								}
								else_if = {
									limit = { development = 6 }
									change_variable = { which = cu_road_level value = 1 }
								}
								if = { #Remnants of Ancient Roman Road
									limit = {
										OR = {
											area = provence_area
											area = home_counties_area
											area = thrace_area
											region = italy_region
										}
										development = 15
										NOT = { check_variable = { which = cu_road_level value = 3 } }
									}
									change_variable = { which = cu_road_level value = 1 }
								}
								else_if = { #Ancient Chinese Road
									limit = {
										OR = {
											region = south_china_region
											region = xinan_region
											region = north_china_region
										}
										OR = {
											fort_level = 2
											province_has_center_of_trade_of_level = 1
											development = 15
										}
										NOT = { check_variable = { which = cu_road_level value = 3 } }
									}
									change_variable = { which = cu_road_level value = 1 }
								}
								cu_update_road_level = yes
								#Road Complete
							  if = {
							        limit = { culture_group = dutch_g }
									change_variable = { which = literacy value = 18 }
							  }
							  else_if = {
							        limit = { cu_germanic_group = yes }
									change_variable = { which = literacy value = 18 }
							  }
							  else_if = {
							        limit = { culture_group = scandinavian }
									change_variable = { which = literacy value = 19 }
							  }
							  else_if = {
							        limit = { culture_group = british }
									change_variable = { which = literacy value = 19 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = gallo_italic
									}
									change_variable = { which = literacy value = 15.5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = southern_french
									}
									change_variable = { which = literacy value = 15 }
							  }
							  else_if = {
							        limit = { 
									         cu_gaelic_group = yes								 
									}
									change_variable = { which = literacy value = 10 }
									if = {
										limit = { culture = tuscan }
										change_variable = { which = literacy value = 2 }
									}
							  }
							  else_if = {
							        limit = { 
									         culture_group = latin 									 
									}
									change_variable = { which = literacy value = 9 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = iberian 										 
									}
									change_variable = { which = literacy value = 13 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = french										 
									}
									change_variable = { which = literacy value = 20 }
							  }
							  else_if = {
								limit = { 
										 culture_group = arpitan_g										 
								}
								change_variable = { which = literacy value = 14 }
						  		}
							  else_if = {
							        limit = { 
									         culture_group = finno_ugric									 
									}
									change_variable = { which = literacy value = 8 }
							  }
							  else_if = {
							        limit = { 
									         cu_south_slavic_group = yes #Only use for making old codes stable										 
									}
									change_variable = { which = literacy value = 6 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = romanan									 
									}
									change_variable = { which = literacy value = 6 }
							  }
							  
							  else_if = {
							        limit = { 
									         culture_group = basque_g							 
									}
									change_variable = { which = literacy value = 5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = west_slavic										 
									}
									change_variable = { which = literacy value = 12 }
							  }							  
							  else_if = {
								limit = { 
										 culture_group = cechitian										 
								}
								change_variable = { which = literacy value = 12 }
							  }		
							  else_if = {
								limit = { 
										 culture_group = sorbian_g									 
								}
								change_variable = { which = literacy value = 12 }
						 	  }		
							  else_if = {
							        limit = { 
									         culture_group = east_slavic								 
									}
									change_variable = { which = literacy value = 7 } #Peter's reform
							  }
							  else_if = {
							        limit = { 
									         cu_baltic_group = yes							 
									}
									change_variable = { which = literacy value = 6 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = byzantine						 
									}
									change_variable = { which = literacy value = 7 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = west_turk_g			 
									}
									change_variable = { which = literacy value = 4.5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = pontic_greek						 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = turko_semitic						 
									}
									change_variable = { which = literacy value = 7 }
							  }							  
							  else_if = {
							        limit = { 
									         cu_iranian_group = yes					 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = east_asian					 
									}
									change_variable = { which = literacy value = 5 }
							  }
							  else_if = {
								limit = { 
									cu_minor_chinese_group = yes				 
								}
								change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = korean_g
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = japanese_g					 
									}
									change_variable = { which = literacy value = 4 }
							  }
							  else_if = {
							        limit = { 
										cu_india_culture = yes				 
									}
									change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = mande
									}
									change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
								limit = { 
										culture_group = gothic
								}
								change_variable = { which = literacy value = 2 }
							 }
							  set_province_flag = literacy_init
						}
						set_variable = { which = lit_g value = 0 } #Literacy Growth
						
                 } 

                 #1750 Start
                 if = {
                       limit = { has_global_flag = start_1750 }
                       
                            set_variable = { which = literacy value = 1 } #Literacy
					        if = {
							  limit = { is_empty = no }
							  #Initialize Road
								set_variable = { which = cu_road_level value = 0 }
								if = {
									limit = { development = 23 }
									change_variable = { which = cu_road_level value = 6 }
								}
								else_if = {
									limit = { development = 19 }
									change_variable = { which = cu_road_level value = 5 }
								}
								else_if = {
									limit = { development = 14 }
									change_variable = { which = cu_road_level value = 4 }
								}
								else_if = {
									limit = { development = 10 }
									change_variable = { which = cu_road_level value = 3 }
								}
								else_if = {
									limit = { development = 8 }
									change_variable = { which = cu_road_level value = 2 }
								}
								else_if = {
									limit = { development = 6 }
									change_variable = { which = cu_road_level value = 1 }
								}
								if = { #Remnants of Ancient Roman Road
									limit = {
										OR = {
											area = provence_area
											area = home_counties_area
											area = thrace_area
											region = italy_region
										}
										development = 15
										NOT = { check_variable = { which = cu_road_level value = 3 } }
									}
									change_variable = { which = cu_road_level value = 1 }
								}
								else_if = { #Ancient Chinese Road
									limit = {
										OR = {
											region = south_china_region
											region = xinan_region
											region = north_china_region
										}
										OR = {
											fort_level = 2
											province_has_center_of_trade_of_level = 1
											development = 15
										}
										NOT = { check_variable = { which = cu_road_level value = 3 } }
									}
									change_variable = { which = cu_road_level value = 1 }
								}
								else_if = { #The first railroad
									limit = {
										is_year = 1815
										area = home_counties_area
									}
									set_variable = { which = cu_road_level value = 10 }
								}
								cu_update_road_level = yes
								#Road Complete
							  if = {
							        limit = { culture_group = dutch_g }
									change_variable = { which = literacy value = 24 }
							  }
							  else_if = {
							        limit = { cu_germanic_group = yes }
									change_variable = { which = literacy value = 27 }
							  }
							  else_if = {
							        limit = { culture_group = scandinavian }
									change_variable = { which = literacy value = 27 }
							  }
							  else_if = {
							        limit = { culture_group = british }
									change_variable = { which = literacy value = 29 }
							  }
							  else_if = {
							        limit = { 
									         cu_gaelic_group = yes								 
									}
									change_variable = { which = literacy value = 11 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = gallo_italic
									}
									change_variable = { which = literacy value = 19.5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = southern_french
									}
									change_variable = { which = literacy value = 20 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = latin 									 
									}
									change_variable = { which = literacy value = 12 }
									if = {
										limit = { culture = tuscan }
										change_variable = { which = literacy value = 2 }
									}
							  }
							  else_if = {
							        limit = { 
									         culture_group = iberian 										 
									}
									change_variable = { which = literacy value = 14 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = french										 
									}
									change_variable = { which = literacy value = 24 }
							  }
							  else_if = {
								limit = { 
										 culture_group = arpitan_g										 
								}
								change_variable = { which = literacy value = 18 }
						  		}
							  else_if = {
							        limit = { 
									         culture_group = finno_ugric									 
									}
									change_variable = { which = literacy value = 12 }
							  }
							  else_if = {
							        limit = { 
									         cu_south_slavic_group = yes #Only use for making old codes stable										 
									}
									change_variable = { which = literacy value = 8 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = romanan									 
									}
									change_variable = { which = literacy value = 7 }
							  }
							  
							  else_if = {
							        limit = { 
									         culture_group = basque_g							 
									}
									change_variable = { which = literacy value = 10 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = west_slavic										 
									}
									change_variable = { which = literacy value = 14 }
							  }							  
							  else_if = {
								limit = { 
										 culture_group = cechitian										 
								}
								change_variable = { which = literacy value = 14 }
							  }		
							  else_if = {
								limit = { 
										 culture_group = sorbian_g									 
								}
								change_variable = { which = literacy value = 14 }
						 	  }		
							  else_if = {
							        limit = { 
									         culture_group = east_slavic								 
									}
									change_variable = { which = literacy value = 9 }
							  }
							  else_if = {
							        limit = { 
									         cu_baltic_group = yes							 
									}
									change_variable = { which = literacy value = 9 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = byzantine						 
									}
									change_variable = { which = literacy value = 8 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = west_turk_g			 
									}
									change_variable = { which = literacy value = 5 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = pontic_greek						 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = turko_semitic						 
									}
									change_variable = { which = literacy value = 8 }
							  }							  
							  else_if = {
							        limit = { 
									         cu_iranian_group = yes					 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = east_asian					 
									}
									change_variable = { which = literacy value = 4 }
							  }
							  else_if = {
								limit = { 
									cu_minor_chinese_group = yes				 
								}
								change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = korean_g
									}
									change_variable = { which = literacy value = 2 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = japanese_g					 
									}
									change_variable = { which = literacy value = 6 }
							  }
							  else_if = {
							        limit = { 
										cu_india_culture = yes			 
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
							        limit = { 
									         culture_group = mande
									}
									change_variable = { which = literacy value = 3 }
							  }
							  else_if = {
								limit = { 
										culture_group = gothic
								}
								change_variable = { which = literacy value = 2 }
							 }
							  set_province_flag = literacy_init
						}
						set_variable = { which = lit_g value = 0 } #Literacy Growth
				 }
			            if = {
					       limit = { 
						             cu_not_terr_trigger = yes									 
						   }
						   owner = { 
						          change_variable = { which =  literacy which = PREV }
					              change_variable = { which =  num_pp value = 1 }
								  change_variable = { which = sum_literacy which = literacy }
					       }
						}
						if = {
							limit = {
								NOT = { has_province_flag = cu_neednt_dev_initialize }
							}
							cu_province_dev_initialization = yes
						}
						cu_province_capacity_initialization = yes
						cu_reset_cultural_acceptance = yes #Initialize Cultural Acceptance
}

cu_province_capacity_initialization = {
	if = {
		limit = { 
			base_manpower = 20 
		}
		change_variable = { which = b_ac value = 19 }
	}
	if = {
		limit = { 
			base_manpower = 18 
			NOT = { base_manpower = 20 }
		}
		change_variable = { which = b_ac value = 17 }
	}
	if = {
		limit = { 
			base_manpower = 16 
			NOT = { base_manpower = 18 }
		}
		change_variable = { which = b_ac value = 15 }
	}
	if = {
		limit = { 
			base_manpower = 14 
			NOT = { base_manpower = 16 }
		}
		change_variable = { which = b_ac value = 13 }
	}
	if = {
		limit = { 
			base_manpower = 12 
			NOT = { base_manpower = 14 }
		}
		change_variable = { which = b_ac value = 11 }
	}
	if = {
		limit = { 
			base_manpower = 10 
			NOT = { base_manpower = 12 }
		}
		change_variable = { which = b_ac value = 9 }
	}
	if = {
		limit = { 
			base_manpower = 8 
			NOT = { base_manpower = 10 }
		}
		change_variable = { which = b_ac value = 7 }
	}
	if = {
		limit = { 
			base_manpower = 6 
			NOT = { base_manpower = 8 }
		}
		change_variable = { which = b_ac value = 5 }
	}
	if = {
		limit = { 
			base_manpower = 4
			NOT = { base_manpower = 6 }
		}
		change_variable = { which = b_ac value = 3 }
	}
	if = {
		limit = { 
			base_manpower = 2 
			NOT = { base_manpower = 4 }
		}
		change_variable = { which = b_ac value = 2 }
	}
	if = {
		limit = { 
			NOT = { base_manpower = 2 }
		}
		change_variable = { which = b_ac value = 1 }
	}
	if = {
		limit = { 
			base_tax = 10
		}
		change_variable = { which = b_uc value = 6 }
	}
	if = {
		limit = { 
			base_tax = 8 
			NOT = { base_tax = 10 }
		}
		change_variable = { which = b_uc value = 5 }
	}
	if = {
		limit = { 
			base_tax = 6 
			NOT = { base_tax = 8 }
		}
		change_variable = { which = b_uc value = 4 }
	}
	if = {
		limit = { 
			base_tax = 4 
			NOT = { base_tax = 6 }
		}
		change_variable = { which = b_uc value = 3 }
	}
	if = {
		limit = { 
			base_tax = 3 
			NOT = { base_tax = 4 }
		}
		change_variable = { which = b_uc value = 2 }
	}
	if = {
		limit = { 
			base_tax = 2 
			NOT = { base_tax = 3 }
		}
		change_variable = { which = b_uc value = 1 }
	}
	if = {
		limit = { 
			base_production = 10
		}
		change_variable = { which = b_uc value = 5 }
	}
	if = {
		limit = { 
			base_production = 8 
			NOT = { base_production = 10 }
		}
		change_variable = { which = b_uc value = 4 }
	}
	if = {
		limit = { 
			base_production = 6 
			NOT = { base_production = 8 }
		}
		change_variable = { which = b_uc value = 3 }
	}
	if = {
		limit = { 
			base_production = 4 
			NOT = { base_production = 6 }
		}
		change_variable = { which = b_uc value = 2 }
	}
	if = {
		limit = { 
			base_production = 2 
			NOT = { base_production = 4 }
		}
		change_variable = { which = b_uc value = 1 }
	}
	if = {
		limit = { 
			province_id = 151
		}
		change_variable = { which = b_uc value = 10 }
	}
  	if = {
		limit = { 
			owner = { is_nomad = yes }
			has_terrain = steppe
			base_manpower = 3											  
		}
		change_variable = { which = b_ac value = -1 }
		if = {
			limit = { base_manpower = 5 }
			change_variable = { which = b_ac value = -1 }
		}
		if = {
			limit = { base_manpower = 7 }
			change_variable = { which = b_ac value = -1 }
		}
		if = {
			limit = { base_manpower = 9 }
			change_variable = { which = b_ac value = -1 }
		}
   	}
}

cu_province_dev_initialization = {
				if = {
						limit = { is_empty = no }
						if = {
							limit = {  
									NOT = { development = 4 }
									base_manpower = 2
							}
							add_base_manpower = 1
						}
				}
				else = {
						if = {
							limit = { base_tax = 5 }
							add_base_tax = -1
						}
						if = {
							limit = { base_tax = 4 }
							add_base_tax = -1
						}
						if = {
							limit = { base_tax = 3 }
							add_base_tax = -1
						}
						if = {
							limit = { base_tax = 2 }
							add_base_tax = -1
						}
						if = {
							limit = { base_production = 5 }
							add_base_production = -1
						}
						if = {
							limit = { base_production = 4 }
							add_base_production = -1
						}
						if = {
							limit = { base_production = 3 }
							add_base_production = -1
						}
						if = {
							limit = { base_production = 2 }
							add_base_production = -1
						}
						if = {
							limit = { base_manpower = 5 }
							add_base_manpower = -1
						}
						if = {
							limit = { base_manpower = 4 }
							add_base_manpower = -1
						}
						if = {
							limit = { base_manpower = 3 }
							add_base_manpower = -1
						}
						if = {
							limit = { 
								OR = {
									continent = north_america
									continent = south_america
								}
							}
							if = {
								limit = { base_tax = 3 }
								add_base_tax = -1
							}
							if = {
								limit = { base_tax = 2 }
								add_base_tax = -1
							}
							if = {
								limit = { base_production = 3 }
								add_base_production = -1
							}
							if = {
								limit = { base_production = 2 }
								add_base_production = -1
							}
							if = {
								limit = { base_manpower = 3 }
								add_base_manpower = -1
							}
							if = {
								limit = { base_manpower = 2 }
								add_base_manpower = -1
							}
						}
				}
				#1444 Start
                if = {
					limit = { has_global_flag = start_1444 }
						   if = {
								 limit = { base_tax = 13 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 10 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 8 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 5 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 3 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 12 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 9 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 7 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 5 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 2 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { 
										 NOT = { base_tax = 1 }
										 NOT = { base_production = 1 }
										 base_manpower = 2
										 NOT = { base_manpower = 4 }
										 
										   
								 }
								 add_base_manpower = -1
								 if = {
									 limit = { base_manpower = 2 }
									 add_base_manpower = -1
								 }
								 
						   }
						   
						   
						   if = {
								 limit = { 
										   NOT = { continent = europe }
										   base_tax = 7										  
								 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { 
										   NOT = { continent = europe }
										   base_production = 6											  
								 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { 
										   OR = {
												  province_has_center_of_trade_of_level = 1
												  province_has_center_of_trade_of_level = 2
												  province_has_center_of_trade_of_level = 3
										   }											  
								 }
								 add_base_tax = 1
								 add_base_manpower = -1
						   }
						   if = {
								 limit = { 
										   OR = { 
												   continent = north_america
												   continent = south_america
										   }
										   base_tax = 2	
										   base_production = 2											  
								 }
								 add_base_tax = -1
								 add_base_production = -1
								 add_base_manpower = 2
						   }
					
			  }
		 #1500 Start
			 if = {
					limit = { has_global_flag = start_1500 }
						   if = {
								 limit = { base_tax = 11 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 9 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 5 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 2 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 10 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 7 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 4 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 2 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   
						   
						   if = {
								 limit = { 
										   NOT = { continent = europe }
										   base_tax = 7										  
								 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { 
										   NOT = { continent = europe }
										   base_production = 6											  
								 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { 
										   OR = {
												  province_has_center_of_trade_of_level = 1
												  province_has_center_of_trade_of_level = 2
												  province_has_center_of_trade_of_level = 3
										   }											  
								 }
								 add_base_tax = 1
								 add_base_manpower = -1
						   }
						   if = {
								 limit = { 
										   OR = { 
												   continent = north_america
												   continent = south_america
										   }
										   base_tax = 2	
										   base_production = 2											  
								 }
								 add_base_tax = -1
								 add_base_production = -1
								 add_base_manpower = 2
						   }
						   if = { 
								  limit = { 
											OR = {
													has_terrain = farmlands
													has_terrain = grasslands
											}
								  }
								  if = { 
										 limit = {
													development = 18
										 }
										 add_base_manpower = 1
								  }
						   }
						   if = { 
										 limit = {
													development = 15
													OR = {
															 province_has_center_of_trade_of_level = 1
															 province_has_center_of_trade_of_level = 2
															 province_has_center_of_trade_of_level = 3
															 has_province_modifier = river_estuary_modifier
											}
										 }
										 add_building = marketplace
						   }
							if = { 
										 limit = {
													base_manpower = 10
													cu_not_terr_trigger = yes
													OR = {
														  has_owner_culture = yes
														  has_owner_accepted_culture = yes
													}
										 }
										 add_building = barracks
						   }
					
			  } 

			  #1550 Start
			  if = {
					limit = { has_global_flag = start_1550 }
						   if = {
								 limit = { base_tax = 12 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 9 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 5 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 2 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 10 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 8 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 5 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 2 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   
						   
						   if = {
								 limit = { 
										   NOT = { continent = europe }
										   base_tax = 7										  
								 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { 
										   NOT = { continent = europe }
										   base_production = 6											  
								 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { 
										   OR = {
												  province_has_center_of_trade_of_level = 1
												  province_has_center_of_trade_of_level = 2
												  province_has_center_of_trade_of_level = 3
										   }											  
								 }
								 add_base_tax = 1
								 add_base_manpower = -1
						   }
						   if = {
								 limit = { 
										   OR = { 
												   continent = north_america
												   continent = south_america
										   }
										   base_tax = 2	
										   base_production = 2											  
								 }
								 add_base_tax = -1
								 add_base_production = -1
								 add_base_manpower = 2
						   }
						   if = { 
								  limit = { 
											OR = {
													has_terrain = farmlands
													has_terrain = grasslands
											}
								  }
								  if = { 
										 limit = {
													development = 14
										 }
										 add_base_manpower = 1
								  }
						   }
						   if = { 
								  limit = { 
											OR = {
													has_terrain = hills
													has_terrain = woods
													has_terrain = forest
											}
								  }
								  if = { 
										 limit = {
													development = 13
										 }
										 add_base_manpower = 1
								  }
						   }
						   if = { 
										 limit = {
													development = 12
													OR = {
														 province_has_center_of_trade_of_level = 1
														 province_has_center_of_trade_of_level = 2
														 province_has_center_of_trade_of_level = 3
														 has_province_modifier = river_estuary_modifier
											}
										 }
										 add_building = marketplace
						   }
						   if = { 
										 limit = {
													base_manpower = 9
													cu_not_terr_trigger = yes
													OR = {
														  has_owner_culture = yes
														  has_owner_accepted_culture = yes
													}
										 }
										 add_building = barracks
						   }
					
			  } 

			  #1600 Start
			  if = {
					limit = { has_global_flag = start_1600 }
						   if = {
								 limit = { base_tax = 12 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 10 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 5 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 2 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 11 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 9 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 5 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 2 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   
						   
						   if = {
								 limit = { 
										   NOT = { continent = europe }
										   base_tax = 7										  
								 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { 
										   NOT = { continent = europe }
										   base_production = 7											  
								 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { 
										   OR = {
												  province_has_center_of_trade_of_level = 1
												  province_has_center_of_trade_of_level = 2
												  province_has_center_of_trade_of_level = 3
										   }											  
								 }
								 add_base_tax = 1
								 add_base_manpower = -1
						   }
						   if = { 
								  limit = { 
											OR = {
													has_terrain = farmlands
													has_terrain = grasslands
											}
								  }
								  if = { 
										 limit = {
													development = 12
													NOT = { development = 18 }
										 }
										 random_list = {
											 33 = { add_base_tax = 1 }
											 33 = { add_base_production = 1 }
														 33 = { add_base_manpower = 1 }
								 }
								  }
								  if = { 
										 limit = {
													development = 18
										 }
										 add_base_manpower = 1
										 random_list = {
											 60 = { add_base_tax = 1 }
											 40 = { add_base_production = 1 }
								 }
								  }
						   }
						   if = { 
								  limit = { 
											OR = {
													has_terrain = hills
													has_terrain = woods
													has_terrain = forest
											}
								  }
								  if = { 
										 limit = {
													development = 12
										 }
										 add_base_manpower = 1
								  }
						   }
						   if = { 
										 limit = {
													development = 9
													OR = {
														 province_has_center_of_trade_of_level = 1
														 province_has_center_of_trade_of_level = 2
														 province_has_center_of_trade_of_level = 3
														 has_province_modifier = river_estuary_modifier
											}
										 }
										 add_building = marketplace
						   }
						   if = { 
										 limit = {
													OR = {
															development = 15
															is_capital = yes
													}
													is_overseas = no
													owner = {
															 OR = {
																	technology_group = western
																	technology_group = eastern
																	technology_group = ottoman
															 }
													}
										 }
										 add_building = courthouse
						   }
						   if = { 
										 limit = {
													base_manpower = 8
													cu_not_terr_trigger = yes
													OR = {
														  has_owner_culture = yes
														  has_owner_accepted_culture = yes
													}
										 }
										 add_building = barracks
						   }
					
			  } 

			  #1650 Start
			  if = {
					limit = { has_global_flag = start_1650 }
						   if = {
								 limit = { base_tax = 13 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 10 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 5 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 2 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 12 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 9 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 5 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 2 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   
						   
						   if = {
								 limit = { 
										   NOT = { continent = europe }
										   base_tax = 7										  
								 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { 
										   NOT = { continent = europe }
										   base_production = 7											  
								 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { 
										   OR = {
												  province_has_center_of_trade_of_level = 1
												  province_has_center_of_trade_of_level = 2
												  province_has_center_of_trade_of_level = 3
										   }											  
								 }
								 add_base_tax = 1
								 add_base_manpower = -1
						   }
						   
						   if = { 
								  limit = { 
											OR = {
													has_terrain = farmlands
													has_terrain = grasslands
											}
								  }
								  if = { 
										 limit = {
													development = 9
													NOT = { development = 15 }
										 }
										 add_base_manpower = 1
								  }
								  if = { 
										 limit = {
													development = 15
										 }
										 add_base_manpower = 1
										 random_list = {
											 55 = { add_base_tax = 1 }
											 45 = { add_base_production = 1 }
								 }
								  }
						   }
						   if = { 
								  limit = { 
											OR = {
													has_terrain = hills
													has_terrain = woods
													has_terrain = forest
											}
								  }
								  if = { 
										 limit = {
													development = 9
													NOT = { development = 15 }
										 }
										 add_base_manpower = 1
								  }
								  if = { 
										 limit = {
													development = 15
										 }
										 add_base_manpower = 1
										 random_list = {
											 55 = { add_base_tax = 1 }
											 45 = { add_base_production = 1 }
								 }
								  }
						   }
						   if = { 
										 limit = {
													development = 7
													OR = {
														 province_has_center_of_trade_of_level = 1
														 province_has_center_of_trade_of_level = 2
														 province_has_center_of_trade_of_level = 3
														 has_province_modifier = river_estuary_modifier
											}
										 }
										 add_building = marketplace
						   }
						   if = { 
										 limit = {
													OR = {
															development = 15
															is_capital = yes
													}
													is_overseas = no
													owner = {
															 OR = {
																	technology_group = western
																	technology_group = eastern
																	technology_group = ottoman
															 }
													}
										 }
										 add_building = courthouse
						   }
						   if = { 
										 limit = {
													base_production = 8
													cu_not_terr_trigger = yes
													has_port = yes
										 }
										 add_building = shipyard
						   }
						   if = { 
										 limit = {
													base_manpower = 7
													cu_not_terr_trigger = yes
													OR = {
														  has_owner_culture = yes
														  has_owner_accepted_culture = yes
													}
										 }
										 add_building = barracks
						   }
					
			  } 

			  #1700 Start
			  if = {
					limit = { has_global_flag = start_1700 }
						   if = {
								 limit = { base_tax = 14 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 11 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 6 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 2 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 13 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 10 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 6 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 2 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   
						   
						   if = {
								 limit = { 
										   NOT = { continent = europe }
										   base_tax = 7										  
								 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { 
										   NOT = { continent = europe }
										   base_production = 7											  
								 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { 
										   OR = {
												  province_has_center_of_trade_of_level = 1
												  province_has_center_of_trade_of_level = 2
												  province_has_center_of_trade_of_level = 3
										   }											  
								 }
								 add_base_tax = 1
								 add_base_manpower = -1
						   }
						   
						   if = { 
								  limit = { 
											OR = {
													has_terrain = farmlands
													has_terrain = grasslands
											}
								  }
								  if = { 
										 limit = {
													development = 7
													NOT = { development = 12 }
										 }
										 add_base_manpower = 1
								  }
								  if = { 
										 limit = {
													development = 12
													NOT = { development = 18 }
										 }
										 add_base_manpower = 1
										 random_list = {
											 50 = { add_base_tax = 1 }
											 50 = { add_base_production = 1 }
								 }
								  }
								  if = { 
										 limit = {
													development = 18
										 }
										 add_base_manpower = 1
										 random_list = {
											 33 = { add_base_tax = 1 }
											 33 = { add_base_production = 1 }
														 33 = { add_base_manpower = 1 }
								 }
										 random_list = {
											 50 = { add_base_tax = 1 }
											 50 = { add_base_production = 1 }
								 }
								  }
						   }
						   if = { 
								  limit = { 
											OR = {
													has_terrain = hills
													has_terrain = woods
													has_terrain = forest
											}
								  }
								  if = { 
										 limit = {
													development = 7
													NOT = { development = 12 }
										 }
										 add_base_manpower = 1
								  }
								  if = { 
										 limit = {
													development = 12
										 }
										 add_base_manpower = 1
										 random_list = {
											 50 = { add_base_tax = 1 }
											 50 = { add_base_production = 1 }
								 }
								  }
						   }
						   if = { 
										 limit = {
													development = 6
													OR = {
														 province_has_center_of_trade_of_level = 1
														 province_has_center_of_trade_of_level = 2
														 province_has_center_of_trade_of_level = 3
														 has_province_modifier = river_estuary_modifier
											}
										 }
										 add_building = marketplace
						   }
						   if = { 
										 limit = {
													OR = {
															development = 15
															is_capital = yes
													}
													is_overseas = no
													owner = {
															 OR = {
																	technology_group = western
																	technology_group = eastern
																	technology_group = ottoman
															 }
													}
										 }
										 add_building = courthouse
						   }
						   if = { 
										 limit = {
													base_production = 8
													cu_not_terr_trigger = yes
													has_port = yes
										 }
										 add_building = shipyard
						   }
						   if = { 
										 limit = {
													base_manpower = 6
													cu_not_terr_trigger = yes
													OR = {
														  has_owner_culture = yes
														  has_owner_accepted_culture = yes
													}
										 }
										 add_building = barracks
						   }
					
			  } 

			  #1750 Start
			  if = {
					limit = { has_global_flag = start_1750 }
						   if = {
								 limit = { base_tax = 13 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 11 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 6 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_tax = 2 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 13 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 11 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 6 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { base_production = 2 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   
						   
						   if = {
								 limit = { 
										   NOT = { continent = europe }
										   base_tax = 8										  
								 }
								 add_base_tax = -1
								 add_base_manpower = 1
						   }
						   if = {
								 limit = { 
										   NOT = { continent = europe }
										   base_production = 7											  
								 }
								 add_base_production = -1
								 add_base_manpower = 1
						   }
						   if = { 
								  limit = { 
											OR = {
													has_terrain = farmlands
													has_terrain = grasslands
											}
								  }
								  if = { 
										 limit = {
													development = 6
													NOT = { development = 10 }
										 }
										 add_base_manpower = 1
								  }
								  if = { 
										 limit = {
													development = 10
													NOT = { development = 16 }
										 }
										 add_base_manpower = 1
										 random_list = {
											 50 = { add_base_tax = 1 }
											 50 = { add_base_production = 1 }
								 }
								  }
								  if = { 
										 limit = {
													development = 16
										 }
										 add_base_manpower = 1
										 random_list = {
											 33 = { add_base_tax = 1 }
											 33 = { add_base_production = 1 }
														 33 = { add_base_manpower = 1 }
								 }
										 random_list = {
											 50 = { add_base_tax = 1 }
											 50 = { add_base_production = 1 }
								 }
								  }
						   }
						   if = { 
								  limit = { 
											OR = {
													has_terrain = hills
													has_terrain = woods
													has_terrain = forest
											}
								  }
								  if = { 
										 limit = {
													development = 6
													NOT = { development = 11 }
										 }
										 add_base_manpower = 1
								  }
								  if = { 
										 limit = {
													development = 11
													NOT = { development = 15 }
										 }
										 add_base_manpower = 1
										 random_list = {
											 50 = { add_base_tax = 1 }
											 50 = { add_base_production = 1 }
								 }
								  }
								  if = { 
										 limit = {
													development = 15
										 }
										 add_base_manpower = 1
										 random_list = {
											 33 = { add_base_tax = 1 }
											 33 = { add_base_production = 1 }
														 33 = { add_base_manpower = 1 }
								 }
										 random_list = {
											 50 = { add_base_tax = 1 }
											 50 = { add_base_production = 1 }
								 }
								  }
						   }
						   if = { 
										 limit = {
													development = 6
													OR = {
														 province_has_center_of_trade_of_level = 1
														 province_has_center_of_trade_of_level = 2
														 province_has_center_of_trade_of_level = 3
														 has_province_modifier = river_estuary_modifier
											}
										 }
										 add_building = marketplace
						   }
						   if = { 
										 limit = {
													OR = {
															development = 15
															is_capital = yes
													}
													is_overseas = no
													owner = {
															 OR = {
																	technology_group = western
																	technology_group = eastern
																	technology_group = ottoman
															 }
													}
										 }
										 add_building = courthouse
						   }
						   if = { 
										 limit = {
													base_manpower = 6
													cu_not_terr_trigger = yes
													OR = {
														  has_owner_culture = yes
														  has_owner_accepted_culture = yes
													}
										 }
										 add_building = barracks
						   }
						   if = { 
										 limit = {
													base_production = 8
													cu_not_terr_trigger = yes
													has_port = yes
										 }
										 add_building = shipyard
						   }
					}
					#Agriculture is increased by 50%
					if = {
						  limit = { 
								   base_manpower = 20 
						  }
						  add_base_manpower = 10
					}
					if = {
						  limit = { 
									base_manpower = 18 
									NOT = { base_manpower = 20 }
						 }
						  add_base_manpower = 9
					}
					if = {
						  limit = { 
									base_manpower = 16 
									NOT = { base_manpower = 18 }
						 }
						  add_base_manpower = 8
					}
					if = {
						  limit = { 
									base_manpower = 14 
									NOT = { base_manpower = 16 }
						 }
						  add_base_manpower = 7
					}
					if = {
						  limit = { 
									base_manpower = 12 
									NOT = { base_manpower = 14 }
						 }
						  add_base_manpower = 6
					}
					if = {
						  limit = { 
									base_manpower = 10 
									NOT = { base_manpower = 12 }
						 }
						  add_base_manpower = 5
					}
					if = {
						  limit = { 
									base_manpower = 8 
									NOT = { base_manpower = 10 }
						 }
						  add_base_manpower = 4
					}
					if = {
						  limit = { 
									base_manpower = 6 
									NOT = { base_manpower = 8 }
						 }
						  add_base_manpower = 3
					}
					if = {
						  limit = { 
									base_manpower = 4
									NOT = { base_manpower = 6 }
						 }
						  add_base_manpower = 2
					}
					if = {
						  limit = { 
									base_manpower = 2 
									NOT = { base_manpower = 4 }
						 }
						  add_base_manpower = 1
					}
					if = {
								 limit = { 
										   owner = { is_nomad = yes }
										   has_terrain = steppe
										   base_manpower = 3											  
								 }
								 add_base_manpower = -1
								 if = {
										 limit = { base_manpower = 5 }
										 add_base_manpower = -1
								 }
								 if = {
										 limit = { base_manpower = 7 }
										 add_base_manpower = -1
								 }
								 if = {
										 limit = { base_manpower = 9 }
										 add_base_manpower = -1
								 }
					 }
}

#cu_add_loan_cash - Change cash(equal loan) by cu_var1 times
cu_add_loan_cash = {
	#Calc loan size
	set_variable = { which = cu_var2 value = 0 }
	set_variable = { which = cu_var3 value = 0 }
	export_to_variable = {
		which = cu_var2
		value = total_development
	}
	export_to_variable = {
		which = cu_var3
		value = trigger_value:trade_efficiency #A bit higher than the actual trade efficiency provided by dip tech
	}
	change_variable = { which = cu_var3 value = 1 }
	if = { 
		limit = {
			check_variable = { which = cu_var3 value = 1.6 }#not higher than the max trade efficiency provided by dip tech
		}
		set_variable = { which = cu_var3 value = 1.6 }
	}
	multiply_variable = { which = cu_var2 which = cu_var3 }
	multiply_variable = { which = cu_var1 which = cu_var2 }
	set_variable = { which = cu_cash which = cu_var1 }
	cu_change_cash = yes
	set_variable = { which = cu_var1 value = 0 }
	set_variable = { which = cu_var2 value = 0 }
	set_variable = { which = cu_var3 value = 0 }
}

#cu_change_cash[cu_cash] - Change cash by cu_cash(-9999 - 9999)
cu_change_cash = {
      if = {
	        limit = { 
			        check_variable = { which = cu_cash value = 1 } 
			        NOT = { check_variable = { which = cu_cash value = 10000 } } 		  
			}
			custom_tooltip = cu_change_cash_t
			hidden_effect = {
			    while = {
			        limit = { check_variable = { which = cu_cash value = 1000 }  }
					add_treasury = 1000
				    subtract_variable = { which = cu_cash value = 1000 }	
				}
			    while = {
			        limit = { check_variable = { which = cu_cash value = 100 }  }
					add_treasury = 100
				    subtract_variable = { which = cu_cash value = 100 }	
				}
				while = {
			        limit = { check_variable = { which = cu_cash value = 10 }  }
					add_treasury = 10
				    subtract_variable = { which = cu_cash value = 10 }	
				}
				while = {
			        limit = { check_variable = { which = cu_cash value = 1 }  }
					add_treasury = 1
				    subtract_variable = { which = cu_cash value = 1 }	
				}
			}
	  }
      else_if = {
	        limit = { 
			        check_variable = { which = cu_cash value = -10000 } 
			        NOT = { check_variable = { which = cu_cash value = 0 } } 		  
			}
			custom_tooltip = cu_change_cash_nt
			multiply_variable = { which = cu_cash value = -1 }
			hidden_effect = {
			    while = {
			        limit = { check_variable = { which = cu_cash value = 1000 }  }
					add_treasury = -1000
				    subtract_variable = { which = cu_cash value = 1000 }	
				}
			    while = {
			        limit = { check_variable = { which = cu_cash value = 100 }  }
					add_treasury = -100
				    subtract_variable = { which = cu_cash value = 100 }	
				}
				while = {
			        limit = { check_variable = { which = cu_cash value = 10 }  }
					add_treasury = -10
				    subtract_variable = { which = cu_cash value = 10 }	
				}
				while = {
			        limit = { check_variable = { which = cu_cash value = 1 }  }
					add_treasury = -1
				    subtract_variable = { which = cu_cash value = 1 }	
				}
			}
	  }
	  hidden_effect = {
	        set_variable = { which = cu_cash value = 0 }
	  }
}

#cu_change_cash_hidden[cu_cash] - Change cash by cu_cash(-9999 - 9999), no tooltip
cu_change_cash_hidden = {
      if = {
	        limit = { 
			        check_variable = { which = cu_cash value = 1 } 
			        NOT = { check_variable = { which = cu_cash value = 10000 } } 		  
			}
			hidden_effect = {
			    while = {
			        limit = { check_variable = { which = cu_cash value = 1000 }  }
					add_treasury = 1000
				    subtract_variable = { which = cu_cash value = 1000 }	
				}
			    while = {
			        limit = { check_variable = { which = cu_cash value = 100 }  }
					add_treasury = 100
				    subtract_variable = { which = cu_cash value = 100 }	
				}
				while = {
			        limit = { check_variable = { which = cu_cash value = 10 }  }
					add_treasury = 10
				    subtract_variable = { which = cu_cash value = 10 }	
				}
				while = {
			        limit = { check_variable = { which = cu_cash value = 1 }  }
					add_treasury = 1
				    subtract_variable = { which = cu_cash value = 1 }	
				}
			}
	  }
      else_if = {
	        limit = { 
			        check_variable = { which = cu_cash value = -10000 } 
			        NOT = { check_variable = { which = cu_cash value = 0 } } 		  
			}
			multiply_variable = { which = cu_cash value = -1 }
			hidden_effect = {
			    while = {
			        limit = { check_variable = { which = cu_cash value = 1000 }  }
					add_treasury = -1000
				    subtract_variable = { which = cu_cash value = 1000 }	
				}
			    while = {
			        limit = { check_variable = { which = cu_cash value = 100 }  }
					add_treasury = -100
				    subtract_variable = { which = cu_cash value = 100 }	
				}
				while = {
			        limit = { check_variable = { which = cu_cash value = 10 }  }
					add_treasury = -10
				    subtract_variable = { which = cu_cash value = 10 }	
				}
				while = {
			        limit = { check_variable = { which = cu_cash value = 1 }  }
					add_treasury = -1
				    subtract_variable = { which = cu_cash value = 1 }	
				}
			}
	  }
	  hidden_effect = {
	        set_variable = { which = cu_cash value = 0 }
	  }
}

#cu_subtract_prestige[cu_prestige]
cu_subtract_prestige = {
	custom_tooltip = cu_subtract_prestige_nt
	hidden_effect = {
		while = {
			limit = { check_variable = { which = cu_prestige value = 100 }  }
			add_prestige = -100
			subtract_variable = { which = cu_prestige value = 100 }	
		}
		while = {
			limit = { check_variable = { which = cu_prestige value = 10 }  }
			add_prestige = -10
			subtract_variable = { which = cu_prestige value = 10 }	
		}
		while = {
			limit = { check_variable = { which = cu_prestige value = 5 }  }
			add_prestige = -5
			subtract_variable = { which = cu_prestige value = 5 }	
		}
		while = {
			limit = { check_variable = { which = cu_prestige value = 0.5 }  }
			add_prestige= -1
			subtract_variable = { which = cu_prestige value = 1 }	
		}
	    set_variable = { which = cu_prestige value = 0 }
	}
}

#cu_change_adm_power - Change ADM power by cu_power, not affected by power cost modifiers.
cu_change_adm_power = {
	if = {
		limit = { check_variable = { which = cu_power value = 1 } }
		custom_tooltip = cu_change_adm_power_pt
		hidden_effect = {
			while = {
				limit = { check_variable = { which = cu_power value = 100 }  }
				add_adm_power = 100
				subtract_variable = { which = cu_power value = 100 }	
			}
			while = {
				limit = { check_variable = { which = cu_power value = 10 }  }
				add_adm_power = 10
				subtract_variable = { which = cu_power value = 10 }	
			}
			while = {
				limit = { check_variable = { which = cu_power value = 5 }  }
				add_adm_power = 5
				subtract_variable = { which = cu_power value = 5 }	
			}
			while = {
				limit = { check_variable = { which = cu_power value = 0.5 }  }
				add_adm_power = 1
				subtract_variable = { which = cu_power value = 1 }	
			}
			set_variable = { which = cu_power value = 0 }
		}
	}
	else_if = {
	    limit = { NOT = { check_variable = { which = cu_power value = -0.99 } } }
		multiply_variable = { which = cu_power value = -1 }
		custom_tooltip = cu_change_adm_power_nt
		hidden_effect = {
			while = {
				limit = { check_variable = { which = cu_power value = 100 }  }
				add_adm_power = -100
				subtract_variable = { which = cu_power value = 100 }	
			}
			while = {
				limit = { check_variable = { which = cu_power value = 10 }  }
				add_adm_power = -10
				subtract_variable = { which = cu_power value = 10 }	
			}
			while = {
				limit = { check_variable = { which = cu_power value = 5 }  }
				add_adm_power = -5
				subtract_variable = { which = cu_power value = 5 }	
			}
			while = {
				limit = { check_variable = { which = cu_power value = 0.5 }  }
				add_adm_power = -1
				subtract_variable = { which = cu_power value = 1 }	
			}
			set_variable = { which = cu_power value = 0 }
		}
	}
}

#cu_change_dip_power - Change DIP power by cu_power, not affected by power cost modifiers.
cu_change_dip_power = {
	if = {
		limit = { check_variable = { which = cu_power value = 1 } }
		custom_tooltip = cu_change_dip_power_pt
		hidden_effect = {
			while = {
				limit = { check_variable = { which = cu_power value = 100 }  }
				add_dip_power = 100
				subtract_variable = { which = cu_power value = 100 }	
			}
			while = {
				limit = { check_variable = { which = cu_power value = 10 }  }
				add_dip_power = 10
				subtract_variable = { which = cu_power value = 10 }	
			}
			while = {
				limit = { check_variable = { which = cu_power value = 5 }  }
				add_dip_power = 5
				subtract_variable = { which = cu_power value = 5 }	
			}
			while = {
				limit = { check_variable = { which = cu_power value = 0.5 }  }
				add_dip_power = 1
				subtract_variable = { which = cu_power value = 1 }	
			}
			set_variable = { which = cu_power value = 0 }
		}
	}
	else_if = {
	    limit = { NOT = { check_variable = { which = cu_power value = -0.99 } } }
		multiply_variable = { which = cu_power value = -1 }
		custom_tooltip = cu_change_dip_power_nt
		hidden_effect = {
			while = {
				limit = { check_variable = { which = cu_power value = 100 }  }
				add_dip_power = -100
				subtract_variable = { which = cu_power value = 100 }	
			}
			while = {
				limit = { check_variable = { which = cu_power value = 10 }  }
				add_dip_power = -10
				subtract_variable = { which = cu_power value = 10 }	
			}
			while = {
				limit = { check_variable = { which = cu_power value = 5 }  }
				add_dip_power = -5
				subtract_variable = { which = cu_power value = 5 }	
			}
			while = {
				limit = { check_variable = { which = cu_power value = 0.5 }  }
				add_dip_power = -1
				subtract_variable = { which = cu_power value = 1 }	
			}
			set_variable = { which = cu_power value = 0 }
		}
	}
}

#cu_change_mil_power - Change MIL power by cu_power, not affected by power cost modifiers.
cu_change_mil_power = {
	if = {
		limit = { check_variable = { which = cu_power value = 1 } }
		custom_tooltip = cu_change_mil_power_pt
		hidden_effect = {
			while = {
				limit = { check_variable = { which = cu_power value = 100 }  }
				add_mil_power = 100
				subtract_variable = { which = cu_power value = 100 }	
			}
			while = {
				limit = { check_variable = { which = cu_power value = 10 }  }
				add_mil_power = 10
				subtract_variable = { which = cu_power value = 10 }	
			}
			while = {
				limit = { check_variable = { which = cu_power value = 5 }  }
				add_mil_power = 5
				subtract_variable = { which = cu_power value = 5 }	
			}
			while = {
				limit = { check_variable = { which = cu_power value = 0.5 }  }
				add_mil_power = 1
				subtract_variable = { which = cu_power value = 1 }	
			}
			set_variable = { which = cu_power value = 0 }
		}
	}
	else_if = {
	    limit = { NOT = { check_variable = { which = cu_power value = -0.99 } } }
		multiply_variable = { which = cu_power value = -1 }
		custom_tooltip = cu_change_mil_power_nt
		hidden_effect = {
			while = {
				limit = { check_variable = { which = cu_power value = 100 }  }
				add_mil_power = -100
				subtract_variable = { which = cu_power value = 100 }	
			}
			while = {
				limit = { check_variable = { which = cu_power value = 10 }  }
				add_mil_power = -10
				subtract_variable = { which = cu_power value = 10 }	
			}
			while = {
				limit = { check_variable = { which = cu_power value = 5 }  }
				add_mil_power = -5
				subtract_variable = { which = cu_power value = 5 }	
			}
			while = {
				limit = { check_variable = { which = cu_power value = 0.5 }  }
				add_mil_power = -1
				subtract_variable = { which = cu_power value = 1 }	
			}
			set_variable = { which = cu_power value = 0 }
		}
	}
}

#cu_calc_power_cost[cu_power](cost) - Calc DIP/ADM/MIL power to cost
#cu_subtract_[dip/adm/mil]_power - Change DIP/ADM/MIL power 

cu_subtract_adm_power = {
	custom_tooltip = cu_subtract_adm_power_nt
	hidden_effect = {
		while = {
			limit = { check_variable = { which = cu_power value = 100 }  }
			add_adm_power = -100
			subtract_variable = { which = cu_power value = 100 }	
		}
		while = {
			limit = { check_variable = { which = cu_power value = 10 }  }
			add_adm_power = -10
			subtract_variable = { which = cu_power value = 10 }	
		}
		while = {
			limit = { check_variable = { which = cu_power value = 5 }  }
			add_adm_power = -5
			subtract_variable = { which = cu_power value = 5 }	
		}
		while = {
			limit = { check_variable = { which = cu_power value = 0.5 }  }
			add_adm_power = -1
			subtract_variable = { which = cu_power value = 1 }	
		}
	    set_variable = { which = cu_power value = 0 }
	}
}

cu_subtract_dip_power = {
	custom_tooltip = cu_subtract_dip_power_nt
	hidden_effect = {
		while = {
			limit = { check_variable = { which = cu_power value = 100 }  }
			add_dip_power = -100
			subtract_variable = { which = cu_power value = 100 }	
		}
		while = {
			limit = { check_variable = { which = cu_power value = 10 }  }
			add_dip_power = -10
			subtract_variable = { which = cu_power value = 10 }	
		}
		while = {
			limit = { check_variable = { which = cu_power value = 5 }  }
			add_dip_power = -5
			subtract_variable = { which = cu_power value = 5 }	
		}
		while = {
			limit = { check_variable = { which = cu_power value = 0.5 }  }
			add_dip_power = -1
			subtract_variable = { which = cu_power value = 1 }	
		}
	    set_variable = { which = cu_power value = 0 }
	}
}


cu_subtract_mil_power = {
	custom_tooltip = cu_subtract_mil_power_nt
	hidden_effect = {
		while = {
			limit = { check_variable = { which = cu_power value = 100 }  }
			add_mil_power = -100
			subtract_variable = { which = cu_power value = 100 }	
		}
		while = {
			limit = { check_variable = { which = cu_power value = 10 }  }
			add_mil_power = -10
			subtract_variable = { which = cu_power value = 10 }	
		}
		while = {
			limit = { check_variable = { which = cu_power value = 5 }  }
			add_mil_power = -5
			subtract_variable = { which = cu_power value = 5 }	
		}
		while = {
			limit = { check_variable = { which = cu_power value = 0.5 }  }
			add_mil_power = -1
			subtract_variable = { which = cu_power value = 1 }	
		}
	    set_variable = { which = cu_power value = 0 }
	}
}

cu_subtract_adm_power_pac = {
	custom_tooltip = cu_subtract_adm_power_pac_nt
	hidden_effect = {
		while = {
			limit = { check_variable = { which = cu_power_pac value = 100 }  }
			add_adm_power = -100
			subtract_variable = { which = cu_power_pac value = 100 }	
		}
		while = {
			limit = { check_variable = { which = cu_power_pac value = 10 }  }
			add_adm_power = -10
			subtract_variable = { which = cu_power_pac value = 10 }	
		}
		while = {
			limit = { check_variable = { which = cu_power_pac value = 5 }  }
			add_adm_power = -5
			subtract_variable = { which = cu_power_pac value = 5 }	
		}
		while = {
			limit = { check_variable = { which = cu_power_pac value = 0.5 }  }
			add_adm_power = -1
			subtract_variable = { which = cu_power_pac value = 1 }	
		}
	    set_variable = { which = cu_power_pac value = 0 }
	}
}

cu_subtract_dip_power_pac = {
	custom_tooltip = cu_subtract_dip_power_pac_nt
	hidden_effect = {
		while = {
			limit = { check_variable = { which = cu_power_pac value = 100 }  }
			add_dip_power = -100
			subtract_variable = { which = cu_power_pac value = 100 }	
		}
		while = {
			limit = { check_variable = { which = cu_power_pac value = 10 }  }
			add_dip_power = -10
			subtract_variable = { which = cu_power_pac value = 10 }	
		}
		while = {
			limit = { check_variable = { which = cu_power_pac value = 5 }  }
			add_dip_power = -5
			subtract_variable = { which = cu_power_pac value = 5 }	
		}
		while = {
			limit = { check_variable = { which = cu_power_pac value = 0.5 }  }
			add_dip_power = -1
			subtract_variable = { which = cu_power_pac value = 1 }	
		}
	    set_variable = { which = cu_power_pac value = 0 }
	}
}

cu_subtract_mil_power_pac = {
	custom_tooltip = cu_subtract_mil_power_pac_nt
	hidden_effect = {
		while = {
			limit = { check_variable = { which = cu_power_pac value = 100 }  }
			add_mil_power = -100
			subtract_variable = { which = cu_power_pac value = 100 }	
		}
		while = {
			limit = { check_variable = { which = cu_power_pac value = 10 }  }
			add_mil_power = -10
			subtract_variable = { which = cu_power_pac value = 10 }	
		}
		while = {
			limit = { check_variable = { which = cu_power_pac value = 5 }  }
			add_mil_power = -5
			subtract_variable = { which = cu_power_pac value = 5 }	
		}
		while = {
			limit = { check_variable = { which = cu_power_pac value = 0.5 }  }
			add_mil_power = -1
			subtract_variable = { which = cu_power_pac value = 1 }	
		}
	    set_variable = { which = cu_power_pac value = 0 }
	}
}
cu_calc_power_cost = {
	hidden_effect = {
		#multiply_variable = { which = cu_power value = -1 }
		#discount for bigger state
		if = {
			limit = {
				NOT = { has_country_modifier = tiny_state }
			}
			
			if = {
				limit = { check_variable = { which = cu_power value = 10 } }
				#modifiered by amont of cost
				if = {
					limit = { check_variable = { which = cu_power value = 70 } }
					set_variable = { which = cu_var3 value = 10 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 65 } }
					set_variable = { which = cu_var3 value = 9 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 60 } }
					set_variable = { which = cu_var3 value = 8 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 50 } }
					set_variable = { which = cu_var3 value = 7 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 45 } }
					set_variable = { which = cu_var3 value = 6 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 40 } }
					set_variable = { which = cu_var3 value = 5 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 30 } }
					set_variable = { which = cu_var3 value = 4 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 20 } }
					set_variable = { which = cu_var3 value = 3 }
				}
				else = {
					set_variable = { which = cu_var3 value = 1 }
				}
				#modifiered by the num of cites of this nation
				if = {
					limit = { has_country_modifier = large_state }
					multiply_variable = { which = cu_var3 value = 2 }
				}
				else_if = {
					limit = { has_country_modifier = huge_state }
					multiply_variable = { which = cu_var3 value = 3 }
				}
				else_if = {
					limit = { has_country_modifier = continental_state }
					multiply_variable = { which = cu_var3 value = 4 }
				}
				else_if = {
					limit = { has_country_modifier = world_state }
					multiply_variable = { which = cu_var3 value = 5 }
				}
				subtract_variable = { which = cu_power which = cu_var3 }
			}
		}
		
		#power cost modifier
		set_variable = { which = cu_var1 value = 0 }
		export_to_variable = {
			which = cu_var1
			value = modifier:all_power_cost
		}
		change_variable = { which = cu_var1 value = 1 }
		cu_calc_government_power_cost_modifier = yes
		cu_calc_distance_power_cost_modifier = yes
		set_variable = { which = cu_var3 value = 0 }
		export_to_variable = {
			which = cu_var3
			value = modifier:expand_administration_cost
		}
		change_variable = { which = cu_var1 which = cu_var3 }
		multiply_variable = { which = cu_power which = cu_var1 }
	}
}

cu_calc_power_cost_country = {
	hidden_effect = {
		#multiply_variable = { which = cu_power value = -1 }
		#discount for bigger state
		if = {
			limit = {
				NOT = { has_country_modifier = tiny_state }
			}
			
			if = {
				limit = { check_variable = { which = cu_power value = 10 } }
				#modifiered by amont of cost
				if = {
					limit = { check_variable = { which = cu_power value = 70 } }
					set_variable = { which = cu_var3 value = 10 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 65 } }
					set_variable = { which = cu_var3 value = 9 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 60 } }
					set_variable = { which = cu_var3 value = 8 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 50 } }
					set_variable = { which = cu_var3 value = 7 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 45 } }
					set_variable = { which = cu_var3 value = 6 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 40 } }
					set_variable = { which = cu_var3 value = 5 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 30 } }
					set_variable = { which = cu_var3 value = 4 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 20 } }
					set_variable = { which = cu_var3 value = 3 }
				}
				else = {
					set_variable = { which = cu_var3 value = 1 }
				}
				#modifiered by the num of cites of this nation
				if = {
					limit = { has_country_modifier = large_state }
					multiply_variable = { which = cu_var3 value = 2 }
				}
				else_if = {
					limit = { has_country_modifier = huge_state }
					multiply_variable = { which = cu_var3 value = 3 }
				}
				else_if = {
					limit = { has_country_modifier = continental_state }
					multiply_variable = { which = cu_var3 value = 4 }
				}
				else_if = {
					limit = { has_country_modifier = world_state }
					multiply_variable = { which = cu_var3 value = 5 }
				}
				subtract_variable = { which = cu_power which = cu_var3 }
			}
		}
		
		#power cost modifier
		set_variable = { which = cu_var1 value = 0 }
		export_to_variable = {
			which = cu_var1
			value = modifier:all_power_cost
		}
		change_variable = { which = cu_var1 value = 1 }
		set_variable = { which = cu_var3 value = 0 }
		export_to_variable = {
			which = cu_var3
			value = modifier:expand_administration_cost
		}
		change_variable = { which = cu_var1 which = cu_var3 }
		multiply_variable = { which = cu_power which = cu_var1 }
	}
}

#Not hidden, in case of multiple hidden_effect
cu_calc_power_cost_uh_country = {
	#multiply_variable = { which = cu_power value = -1 }
	#discount for bigger state
	if = {
		limit = {
			NOT = { has_country_modifier = tiny_state }
		}
		
		if = {
			limit = { check_variable = { which = cu_power value = 10 } }
			#modifiered by amont of cost
			if = {
				limit = { check_variable = { which = cu_power value = 70 } }
				set_variable = { which = cu_var3 value = 10 }
			}
			else_if = { 
				limit = { check_variable = { which = cu_power value = 65 } }
				set_variable = { which = cu_var3 value = 9 }
			}
			else_if = { 
				limit = { check_variable = { which = cu_power value = 60 } }
				set_variable = { which = cu_var3 value = 8 }
			}
			else_if = { 
				limit = { check_variable = { which = cu_power value = 50 } }
				set_variable = { which = cu_var3 value = 7 }
			}
			else_if = { 
				limit = { check_variable = { which = cu_power value = 45 } }
				set_variable = { which = cu_var3 value = 6 }
			}
			else_if = { 
				limit = { check_variable = { which = cu_power value = 40 } }
				set_variable = { which = cu_var3 value = 5 }
			}
			else_if = { 
				limit = { check_variable = { which = cu_power value = 30 } }
				set_variable = { which = cu_var3 value = 4 }
			}
			else_if = { 
				limit = { check_variable = { which = cu_power value = 20 } }
				set_variable = { which = cu_var3 value = 3 }
			}
			else = {
				set_variable = { which = cu_var3 value = 1 }
			}
			#modifiered by the num of cites of this nation
			if = {
				limit = { has_country_modifier = large_state }
				multiply_variable = { which = cu_var3 value = 2 }
			}
			else_if = {
				limit = { has_country_modifier = huge_state }
				multiply_variable = { which = cu_var3 value = 3 }
			}
			else_if = {
				limit = { has_country_modifier = continental_state }
				multiply_variable = { which = cu_var3 value = 4 }
			}
			else_if = {
				limit = { has_country_modifier = world_state }
				multiply_variable = { which = cu_var3 value = 5 }
			}
			subtract_variable = { which = cu_power which = cu_var3 }
		}
	}
	
	#power cost modifier
	set_variable = { which = cu_var1 value = 0 }
	export_to_variable = {
		which = cu_var1
		value = modifier:all_power_cost
	}
	change_variable = { which = cu_var1 value = 1 }
	
	set_variable = { which = cu_var3 value = 0 }
		export_to_variable = {
			which = cu_var3
			value = modifier:expand_administration_cost
		}
		change_variable = { which = cu_var1 which = cu_var3 }
	multiply_variable = { which = cu_power which = cu_var1 }
}

#Not hidden, in case of multiple hidden_effect
cu_calc_power_cost_uh = {
		#multiply_variable = { which = cu_power value = -1 }
		#discount for bigger state
		if = {
			limit = {
				NOT = { has_country_modifier = tiny_state }
			}
			
			if = {
				limit = { check_variable = { which = cu_power value = 10 } }
				#modifiered by amont of cost
				if = {
					limit = { check_variable = { which = cu_power value = 70 } }
					set_variable = { which = cu_var3 value = 10 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 65 } }
					set_variable = { which = cu_var3 value = 9 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 60 } }
					set_variable = { which = cu_var3 value = 8 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 50 } }
					set_variable = { which = cu_var3 value = 7 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 45 } }
					set_variable = { which = cu_var3 value = 6 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 40 } }
					set_variable = { which = cu_var3 value = 5 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 30 } }
					set_variable = { which = cu_var3 value = 4 }
				}
				else_if = { 
					limit = { check_variable = { which = cu_power value = 20 } }
					set_variable = { which = cu_var3 value = 3 }
				}
				else = {
					set_variable = { which = cu_var3 value = 1 }
				}
				#modifiered by the num of cites of this nation
				if = {
					limit = { has_country_modifier = large_state }
					multiply_variable = { which = cu_var3 value = 2 }
				}
				else_if = {
					limit = { has_country_modifier = huge_state }
					multiply_variable = { which = cu_var3 value = 3 }
				}
				else_if = {
					limit = { has_country_modifier = continental_state }
					multiply_variable = { which = cu_var3 value = 4 }
				}
				else_if = {
					limit = { has_country_modifier = world_state }
					multiply_variable = { which = cu_var3 value = 5 }
				}
				subtract_variable = { which = cu_power which = cu_var3 }
			}
		}
		
		#power cost modifier
		set_variable = { which = cu_var1 value = 0 }
		export_to_variable = {
			which = cu_var1
			value = modifier:all_power_cost
		}
		change_variable = { which = cu_var1 value = 1 }
		
		cu_calc_government_power_cost_modifier = yes
		cu_calc_distance_power_cost_modifier = yes
		set_variable = { which = cu_var3 value = 0 }
		export_to_variable = {
			which = cu_var3
			value = modifier:expand_administration_cost
		}
		change_variable = { which = cu_var1 which = cu_var3 }
		multiply_variable = { which = cu_power which = cu_var1 }
}

cu_calc_power_cost_culture = {
	hidden_effect = {
		#power cost modifier
		set_variable = { which = cu_var1 value = 0 }
		export_to_variable = {
			which = cu_var1
			value = modifier:all_power_cost
		}
		change_variable = { which = cu_var1 value = 1 }
		cu_calc_government_power_cost_modifier = yes
		cu_calc_distance_power_cost_modifier = yes
		set_variable = { which = cu_var3 value = 0 }
		export_to_variable = {
			which = cu_var3
			value = modifier:expand_administration_cost
		}
		change_variable = { which = cu_var1 which = cu_var3 }
		multiply_variable = { which = cu_power which = cu_var1 }
	}
}

cu_calc_power_cost_pac = {
		#power cost modifier
		set_variable = { which = cu_var1 value = 0 }
		export_to_variable = {
			which = cu_var1
			value = modifier:all_power_cost
		}
		change_variable = { which = cu_var1 value = 1 }
		set_variable = { which = cu_var2 value = 0 }
		export_to_variable = {
			which = cu_var2
			value = modifier:core_creation
		}
		change_variable = { which = cu_var1 which = cu_var2 }
		multiply_variable = { which = cu_power_pac which = cu_var1 }
		export_to_variable = {
			which = cu_var1
			value = modifier:administrative_efficiency
		}
		multiply_variable = { which = cu_var1 value = -1 }
		change_variable = { which = cu_var1 value = 1 }
		multiply_variable = { which = cu_power_pac which = cu_var1 }
}

cu_calc_government_power_cost_modifier = {
	set_variable = { which = epimg which = ROOT }
	multiply_variable = { which = epimg value = 0.2 }
	change_variable = { which = epimg value = -7.5 }
	divide_variable = { which = epimg value = 100 }
	change_variable = { which = cu_var1 which = epimg }
	if = {
		limit = { ROOT = { has_province_flag = has_estate_burghers } }
		if = { limit = { estate_loyalty = {	estate = estate_burghers	loyalty = 60	} } change_variable = { which = cu_var1 value = -0.05 } }
		if = { limit = { NOT = { estate_loyalty = {	estate = estate_burghers	loyalty = 40	} } } change_variable = { which = cu_var1 value = 0.1 } }
	}
	if = {
		limit = { ROOT = { has_province_flag = has_estate_nobles } }
		if = { limit = { estate_loyalty = {	estate = estate_burghers	loyalty = 60	} } change_variable = { which = cu_var1 value = -0.05 } }
		if = { limit = { NOT = { estate_loyalty = {	estate = estate_burghers	loyalty = 40	} } } change_variable = { which = cu_var1 value = 0.1 } }
	}
	else_if = {
		limit = { ROOT = { has_province_flag = has_estate_qinwang } }
		if = { limit = { estate_loyalty = {	estate = estate_burghers	loyalty = 60	} } change_variable = { which = cu_var1 value = -0.05 } }
		if = { limit = { NOT = { estate_loyalty = {	estate = estate_burghers	loyalty = 40	} } } change_variable = { which = cu_var1 value = 0.1 } }
	}
	if = {
		limit = { ROOT = { has_province_flag = has_estate_church } }
		if = { limit = { estate_loyalty = {	estate = estate_burghers	loyalty = 60	} } change_variable = { which = cu_var1 value = -0.05 } }
		if = { limit = { NOT = { estate_loyalty = {	estate = estate_burghers	loyalty = 40	} } } change_variable = { which = cu_var1 value = 0.1 } }
	}
	else_if = {
		limit = { ROOT = { has_province_flag = has_estate_shizu } }
		if = { limit = { estate_loyalty = {	estate = estate_burghers	loyalty = 60	} } change_variable = { which = cu_var1 value = -0.05 } }
		if = { limit = { NOT = { estate_loyalty = {	estate = estate_burghers	loyalty = 40	} } } change_variable = { which = cu_var1 value = 0.1 } }
	}
	if = {
		limit = { ROOT = { has_province_flag = has_estate_nomadic_tribes } }
		if = { limit = { estate_loyalty = {	estate = estate_nomadic_tribes	loyalty = 60	} } change_variable = { which = cu_var1 value = -0.05 } }
		if = { limit = { NOT = { estate_loyalty = {	estate = estate_nomadic_tribes	loyalty = 40	} } } change_variable = { which = cu_var1 value = 0.1 } }
	}
	else_if = {
		limit = { ROOT = { has_province_flag = has_estate_cossacks } }
		if = { limit = { estate_loyalty = {	estate = estate_cossacks	loyalty = 60	} } change_variable = { which = cu_var1 value = -0.05 } }
		if = { limit = { NOT = { estate_loyalty = {	estate = estate_cossacks	loyalty = 40	} } } change_variable = { which = cu_var1 value = 0.1 } }
	}
	if = {
		
			limit = {
				ROOT = {
					unrest = 0.1
				}
			}
		set_variable = { which = cu_var2 value = 0 }
		export_to_variable = {
			which = cu_var2
			value = trigger_value:unrest
			who = ROOT
		}
		multiply_variable = { which = cu_var2 value = 0.02 }
		change_variable = { which = cu_var1 which = cu_var2 }
	}
}

cu_calc_distance_power_cost_modifier = {
	set_variable = { which = p_dist_tc which = ROOT }
	set_variable = { which = cu_var3 value = 0.05 }
	set_variable = { which = p_passing_speed value = 1 }
	if = {	limit = { ROOT = { has_building = road_1 } } change_variable = { which = p_passing_speed value = 0.1 } }
	else_if = {	limit = { ROOT = { has_building = road_2 } } change_variable = { which = p_passing_speed value = 0.2 } }
	else_if = {	limit = { ROOT = { has_building = road_3 } } change_variable = { which = p_passing_speed value = 0.3 } }
	else_if = {	limit = { ROOT = { has_building = road_4 } } change_variable = { which = p_passing_speed value = 0.4 } }
	else_if = {	limit = { ROOT = { has_building = road_5 } } change_variable = { which = p_passing_speed value = 0.6 } }
	else_if = {	limit = { ROOT = { has_building = road_6 } } change_variable = { which = p_passing_speed value = 0.8 } }
	else_if = {	limit = { ROOT = { has_building = road_7 } } change_variable = { which = p_passing_speed value = 1.0 } }
	else_if = {	limit = { ROOT = { has_building = road_8 } } change_variable = { which = p_passing_speed value = 1.2 } }
	else_if = {	limit = { ROOT = { has_building = road_9 } } change_variable = { which = p_passing_speed value = 1.4 } }
	else_if = {	limit = { ROOT = { has_building = road_10 } } change_variable = { which = p_passing_speed value = 2.0 } }
	divide_variable = { which = cu_var3 which = p_passing_speed }
	if = { limit = { ROOT = { has_province_modifier = connect_to_capital } } change_variable = { which = cu_var3 value = -0.01 } }
	else_if = { limit = { ROOT = { has_province_modifier = connect_to_capital_oversea } } change_variable = { which = cu_var3 value = -0.01 } }
	multiply_variable = { which = cu_var3 which = p_dist_tc }
	change_variable = { which = cu_var1 which = cu_var3 }
}

cu_get_year = { 
     change_variable = { which = cu_year value = 1 }
	 if = {
	      limit = { NOT = { check_variable = { which = cu_year value = 1444 } } }
		  cu_correct_year = yes
	 }
}

cu_get_5year = { 
     change_variable = { which = cu_year value = 5 }
}

cu_initial_year = { #Initializing years, support bookmarks only for now.
    set_variable = { which = cu_year value = 1444 }
	#Generated by code
	if = { limit = { is_year = 1899 } set_variable = { which = cu_year value = 1899 } }
	else_if = { limit = { is_year = 1898 } set_variable = { which = cu_year value = 1898 } }
	else_if = { limit = { is_year = 1897 } set_variable = { which = cu_year value = 1897 } }
	else_if = { limit = { is_year = 1896 } set_variable = { which = cu_year value = 1896 } }
	else_if = { limit = { is_year = 1895 } set_variable = { which = cu_year value = 1895 } }
	else_if = { limit = { is_year = 1894 } set_variable = { which = cu_year value = 1894 } }
	else_if = { limit = { is_year = 1893 } set_variable = { which = cu_year value = 1893 } }
	else_if = { limit = { is_year = 1892 } set_variable = { which = cu_year value = 1892 } }
	else_if = { limit = { is_year = 1891 } set_variable = { which = cu_year value = 1891 } }
	else_if = { limit = { is_year = 1890 } set_variable = { which = cu_year value = 1890 } }
	else_if = { limit = { is_year = 1889 } set_variable = { which = cu_year value = 1889 } }
	else_if = { limit = { is_year = 1888 } set_variable = { which = cu_year value = 1888 } }
	else_if = { limit = { is_year = 1887 } set_variable = { which = cu_year value = 1887 } }
	else_if = { limit = { is_year = 1886 } set_variable = { which = cu_year value = 1886 } }
	else_if = { limit = { is_year = 1885 } set_variable = { which = cu_year value = 1885 } }
	else_if = { limit = { is_year = 1884 } set_variable = { which = cu_year value = 1884 } }
	else_if = { limit = { is_year = 1883 } set_variable = { which = cu_year value = 1883 } }
	else_if = { limit = { is_year = 1882 } set_variable = { which = cu_year value = 1882 } }
	else_if = { limit = { is_year = 1881 } set_variable = { which = cu_year value = 1881 } }
	else_if = { limit = { is_year = 1880 } set_variable = { which = cu_year value = 1880 } }
	else_if = { limit = { is_year = 1879 } set_variable = { which = cu_year value = 1879 } }
	else_if = { limit = { is_year = 1878 } set_variable = { which = cu_year value = 1878 } }
	else_if = { limit = { is_year = 1877 } set_variable = { which = cu_year value = 1877 } }
	else_if = { limit = { is_year = 1876 } set_variable = { which = cu_year value = 1876 } }
	else_if = { limit = { is_year = 1875 } set_variable = { which = cu_year value = 1875 } }
	else_if = { limit = { is_year = 1874 } set_variable = { which = cu_year value = 1874 } }
	else_if = { limit = { is_year = 1873 } set_variable = { which = cu_year value = 1873 } }
	else_if = { limit = { is_year = 1872 } set_variable = { which = cu_year value = 1872 } }
	else_if = { limit = { is_year = 1871 } set_variable = { which = cu_year value = 1871 } }
	else_if = { limit = { is_year = 1870 } set_variable = { which = cu_year value = 1870 } }
	else_if = { limit = { is_year = 1869 } set_variable = { which = cu_year value = 1869 } }
	else_if = { limit = { is_year = 1868 } set_variable = { which = cu_year value = 1868 } }
	else_if = { limit = { is_year = 1867 } set_variable = { which = cu_year value = 1867 } }
	else_if = { limit = { is_year = 1866 } set_variable = { which = cu_year value = 1866 } }
	else_if = { limit = { is_year = 1865 } set_variable = { which = cu_year value = 1865 } }
	else_if = { limit = { is_year = 1864 } set_variable = { which = cu_year value = 1864 } }
	else_if = { limit = { is_year = 1863 } set_variable = { which = cu_year value = 1863 } }
	else_if = { limit = { is_year = 1862 } set_variable = { which = cu_year value = 1862 } }
	else_if = { limit = { is_year = 1861 } set_variable = { which = cu_year value = 1861 } }
	else_if = { limit = { is_year = 1860 } set_variable = { which = cu_year value = 1860 } }
	else_if = { limit = { is_year = 1859 } set_variable = { which = cu_year value = 1859 } }
	else_if = { limit = { is_year = 1858 } set_variable = { which = cu_year value = 1858 } }
	else_if = { limit = { is_year = 1857 } set_variable = { which = cu_year value = 1857 } }
	else_if = { limit = { is_year = 1856 } set_variable = { which = cu_year value = 1856 } }
	else_if = { limit = { is_year = 1855 } set_variable = { which = cu_year value = 1855 } }
	else_if = { limit = { is_year = 1854 } set_variable = { which = cu_year value = 1854 } }
	else_if = { limit = { is_year = 1853 } set_variable = { which = cu_year value = 1853 } }
	else_if = { limit = { is_year = 1852 } set_variable = { which = cu_year value = 1852 } }
	else_if = { limit = { is_year = 1851 } set_variable = { which = cu_year value = 1851 } }
	else_if = { limit = { is_year = 1850 } set_variable = { which = cu_year value = 1850 } }
	else_if = { limit = { is_year = 1849 } set_variable = { which = cu_year value = 1849 } }
	else_if = { limit = { is_year = 1848 } set_variable = { which = cu_year value = 1848 } }
	else_if = { limit = { is_year = 1847 } set_variable = { which = cu_year value = 1847 } }
	else_if = { limit = { is_year = 1846 } set_variable = { which = cu_year value = 1846 } }
	else_if = { limit = { is_year = 1845 } set_variable = { which = cu_year value = 1845 } }
	else_if = { limit = { is_year = 1844 } set_variable = { which = cu_year value = 1844 } }
	else_if = { limit = { is_year = 1843 } set_variable = { which = cu_year value = 1843 } }
	else_if = { limit = { is_year = 1842 } set_variable = { which = cu_year value = 1842 } }
	else_if = { limit = { is_year = 1841 } set_variable = { which = cu_year value = 1841 } }
	else_if = { limit = { is_year = 1840 } set_variable = { which = cu_year value = 1840 } }
	else_if = { limit = { is_year = 1839 } set_variable = { which = cu_year value = 1839 } }
	else_if = { limit = { is_year = 1838 } set_variable = { which = cu_year value = 1838 } }
	else_if = { limit = { is_year = 1837 } set_variable = { which = cu_year value = 1837 } }
	else_if = { limit = { is_year = 1836 } set_variable = { which = cu_year value = 1836 } }
	else_if = { limit = { is_year = 1835 } set_variable = { which = cu_year value = 1835 } }
	else_if = { limit = { is_year = 1834 } set_variable = { which = cu_year value = 1834 } }
	else_if = { limit = { is_year = 1833 } set_variable = { which = cu_year value = 1833 } }
	else_if = { limit = { is_year = 1832 } set_variable = { which = cu_year value = 1832 } }
	else_if = { limit = { is_year = 1831 } set_variable = { which = cu_year value = 1831 } }
	else_if = { limit = { is_year = 1830 } set_variable = { which = cu_year value = 1830 } }
	else_if = { limit = { is_year = 1829 } set_variable = { which = cu_year value = 1829 } }
	else_if = { limit = { is_year = 1828 } set_variable = { which = cu_year value = 1828 } }
	else_if = { limit = { is_year = 1827 } set_variable = { which = cu_year value = 1827 } }
	else_if = { limit = { is_year = 1826 } set_variable = { which = cu_year value = 1826 } }
	else_if = { limit = { is_year = 1825 } set_variable = { which = cu_year value = 1825 } }
	else_if = { limit = { is_year = 1824 } set_variable = { which = cu_year value = 1824 } }
	else_if = { limit = { is_year = 1823 } set_variable = { which = cu_year value = 1823 } }
	else_if = { limit = { is_year = 1822 } set_variable = { which = cu_year value = 1822 } }
	else_if = { limit = { is_year = 1821 } set_variable = { which = cu_year value = 1821 } }
	else_if = { limit = { is_year = 1820 } set_variable = { which = cu_year value = 1820 } }
	else_if = { limit = { is_year = 1819 } set_variable = { which = cu_year value = 1819 } }
	else_if = { limit = { is_year = 1818 } set_variable = { which = cu_year value = 1818 } }
	else_if = { limit = { is_year = 1817 } set_variable = { which = cu_year value = 1817 } }
	else_if = { limit = { is_year = 1816 } set_variable = { which = cu_year value = 1816 } }
	else_if = { limit = { is_year = 1815 } set_variable = { which = cu_year value = 1815 } }
	else_if = { limit = { is_year = 1814 } set_variable = { which = cu_year value = 1814 } }
	else_if = { limit = { is_year = 1813 } set_variable = { which = cu_year value = 1813 } }
	else_if = { limit = { is_year = 1812 } set_variable = { which = cu_year value = 1812 } }
	else_if = { limit = { is_year = 1811 } set_variable = { which = cu_year value = 1811 } }
	else_if = { limit = { is_year = 1810 } set_variable = { which = cu_year value = 1810 } }
	else_if = { limit = { is_year = 1809 } set_variable = { which = cu_year value = 1809 } }
	else_if = { limit = { is_year = 1808 } set_variable = { which = cu_year value = 1808 } }
	else_if = { limit = { is_year = 1807 } set_variable = { which = cu_year value = 1807 } }
	else_if = { limit = { is_year = 1806 } set_variable = { which = cu_year value = 1806 } }
	else_if = { limit = { is_year = 1805 } set_variable = { which = cu_year value = 1805 } }
	else_if = { limit = { is_year = 1804 } set_variable = { which = cu_year value = 1804 } }
	else_if = { limit = { is_year = 1803 } set_variable = { which = cu_year value = 1803 } }
	else_if = { limit = { is_year = 1802 } set_variable = { which = cu_year value = 1802 } }
	else_if = { limit = { is_year = 1801 } set_variable = { which = cu_year value = 1801 } }
	else_if = { limit = { is_year = 1800 } set_variable = { which = cu_year value = 1800 } }
	else_if = { limit = { is_year = 1799 } set_variable = { which = cu_year value = 1799 } }
	else_if = { limit = { is_year = 1798 } set_variable = { which = cu_year value = 1798 } }
	else_if = { limit = { is_year = 1797 } set_variable = { which = cu_year value = 1797 } }
	else_if = { limit = { is_year = 1796 } set_variable = { which = cu_year value = 1796 } }
	else_if = { limit = { is_year = 1795 } set_variable = { which = cu_year value = 1795 } }
	else_if = { limit = { is_year = 1794 } set_variable = { which = cu_year value = 1794 } }
	else_if = { limit = { is_year = 1793 } set_variable = { which = cu_year value = 1793 } }
	else_if = { limit = { is_year = 1792 } set_variable = { which = cu_year value = 1792 } }
	else_if = { limit = { is_year = 1791 } set_variable = { which = cu_year value = 1791 } }
	else_if = { limit = { is_year = 1790 } set_variable = { which = cu_year value = 1790 } }
	else_if = { limit = { is_year = 1789 } set_variable = { which = cu_year value = 1789 } }
	else_if = { limit = { is_year = 1788 } set_variable = { which = cu_year value = 1788 } }
	else_if = { limit = { is_year = 1787 } set_variable = { which = cu_year value = 1787 } }
	else_if = { limit = { is_year = 1786 } set_variable = { which = cu_year value = 1786 } }
	else_if = { limit = { is_year = 1785 } set_variable = { which = cu_year value = 1785 } }
	else_if = { limit = { is_year = 1784 } set_variable = { which = cu_year value = 1784 } }
	else_if = { limit = { is_year = 1783 } set_variable = { which = cu_year value = 1783 } }
	else_if = { limit = { is_year = 1782 } set_variable = { which = cu_year value = 1782 } }
	else_if = { limit = { is_year = 1781 } set_variable = { which = cu_year value = 1781 } }
	else_if = { limit = { is_year = 1780 } set_variable = { which = cu_year value = 1780 } }
	else_if = { limit = { is_year = 1779 } set_variable = { which = cu_year value = 1779 } }
	else_if = { limit = { is_year = 1778 } set_variable = { which = cu_year value = 1778 } }
	else_if = { limit = { is_year = 1777 } set_variable = { which = cu_year value = 1777 } }
	else_if = { limit = { is_year = 1776 } set_variable = { which = cu_year value = 1776 } }
	else_if = { limit = { is_year = 1775 } set_variable = { which = cu_year value = 1775 } }
	else_if = { limit = { is_year = 1774 } set_variable = { which = cu_year value = 1774 } }
	else_if = { limit = { is_year = 1773 } set_variable = { which = cu_year value = 1773 } }
	else_if = { limit = { is_year = 1772 } set_variable = { which = cu_year value = 1772 } }
	else_if = { limit = { is_year = 1771 } set_variable = { which = cu_year value = 1771 } }
	else_if = { limit = { is_year = 1770 } set_variable = { which = cu_year value = 1770 } }
	else_if = { limit = { is_year = 1769 } set_variable = { which = cu_year value = 1769 } }
	else_if = { limit = { is_year = 1768 } set_variable = { which = cu_year value = 1768 } }
	else_if = { limit = { is_year = 1767 } set_variable = { which = cu_year value = 1767 } }
	else_if = { limit = { is_year = 1766 } set_variable = { which = cu_year value = 1766 } }
	else_if = { limit = { is_year = 1765 } set_variable = { which = cu_year value = 1765 } }
	else_if = { limit = { is_year = 1764 } set_variable = { which = cu_year value = 1764 } }
	else_if = { limit = { is_year = 1763 } set_variable = { which = cu_year value = 1763 } }
	else_if = { limit = { is_year = 1762 } set_variable = { which = cu_year value = 1762 } }
	else_if = { limit = { is_year = 1761 } set_variable = { which = cu_year value = 1761 } }
	else_if = { limit = { is_year = 1760 } set_variable = { which = cu_year value = 1760 } }
	else_if = { limit = { is_year = 1759 } set_variable = { which = cu_year value = 1759 } }
	else_if = { limit = { is_year = 1758 } set_variable = { which = cu_year value = 1758 } }
	else_if = { limit = { is_year = 1757 } set_variable = { which = cu_year value = 1757 } }
	else_if = { limit = { is_year = 1756 } set_variable = { which = cu_year value = 1756 } }
	else_if = { limit = { is_year = 1755 } set_variable = { which = cu_year value = 1755 } }
	else_if = { limit = { is_year = 1754 } set_variable = { which = cu_year value = 1754 } }
	else_if = { limit = { is_year = 1753 } set_variable = { which = cu_year value = 1753 } }
	else_if = { limit = { is_year = 1752 } set_variable = { which = cu_year value = 1752 } }
	else_if = { limit = { is_year = 1751 } set_variable = { which = cu_year value = 1751 } }
	else_if = { limit = { is_year = 1750 } set_variable = { which = cu_year value = 1750 } }
	else_if = { limit = { is_year = 1749 } set_variable = { which = cu_year value = 1749 } }
	else_if = { limit = { is_year = 1748 } set_variable = { which = cu_year value = 1748 } }
	else_if = { limit = { is_year = 1747 } set_variable = { which = cu_year value = 1747 } }
	else_if = { limit = { is_year = 1746 } set_variable = { which = cu_year value = 1746 } }
	else_if = { limit = { is_year = 1745 } set_variable = { which = cu_year value = 1745 } }
	else_if = { limit = { is_year = 1744 } set_variable = { which = cu_year value = 1744 } }
	else_if = { limit = { is_year = 1743 } set_variable = { which = cu_year value = 1743 } }
	else_if = { limit = { is_year = 1742 } set_variable = { which = cu_year value = 1742 } }
	else_if = { limit = { is_year = 1741 } set_variable = { which = cu_year value = 1741 } }
	else_if = { limit = { is_year = 1740 } set_variable = { which = cu_year value = 1740 } }
	else_if = { limit = { is_year = 1739 } set_variable = { which = cu_year value = 1739 } }
	else_if = { limit = { is_year = 1738 } set_variable = { which = cu_year value = 1738 } }
	else_if = { limit = { is_year = 1737 } set_variable = { which = cu_year value = 1737 } }
	else_if = { limit = { is_year = 1736 } set_variable = { which = cu_year value = 1736 } }
	else_if = { limit = { is_year = 1735 } set_variable = { which = cu_year value = 1735 } }
	else_if = { limit = { is_year = 1734 } set_variable = { which = cu_year value = 1734 } }
	else_if = { limit = { is_year = 1733 } set_variable = { which = cu_year value = 1733 } }
	else_if = { limit = { is_year = 1732 } set_variable = { which = cu_year value = 1732 } }
	else_if = { limit = { is_year = 1731 } set_variable = { which = cu_year value = 1731 } }
	else_if = { limit = { is_year = 1730 } set_variable = { which = cu_year value = 1730 } }
	else_if = { limit = { is_year = 1729 } set_variable = { which = cu_year value = 1729 } }
	else_if = { limit = { is_year = 1728 } set_variable = { which = cu_year value = 1728 } }
	else_if = { limit = { is_year = 1727 } set_variable = { which = cu_year value = 1727 } }
	else_if = { limit = { is_year = 1726 } set_variable = { which = cu_year value = 1726 } }
	else_if = { limit = { is_year = 1725 } set_variable = { which = cu_year value = 1725 } }
	else_if = { limit = { is_year = 1724 } set_variable = { which = cu_year value = 1724 } }
	else_if = { limit = { is_year = 1723 } set_variable = { which = cu_year value = 1723 } }
	else_if = { limit = { is_year = 1722 } set_variable = { which = cu_year value = 1722 } }
	else_if = { limit = { is_year = 1721 } set_variable = { which = cu_year value = 1721 } }
	else_if = { limit = { is_year = 1720 } set_variable = { which = cu_year value = 1720 } }
	else_if = { limit = { is_year = 1719 } set_variable = { which = cu_year value = 1719 } }
	else_if = { limit = { is_year = 1718 } set_variable = { which = cu_year value = 1718 } }
	else_if = { limit = { is_year = 1717 } set_variable = { which = cu_year value = 1717 } }
	else_if = { limit = { is_year = 1716 } set_variable = { which = cu_year value = 1716 } }
	else_if = { limit = { is_year = 1715 } set_variable = { which = cu_year value = 1715 } }
	else_if = { limit = { is_year = 1714 } set_variable = { which = cu_year value = 1714 } }
	else_if = { limit = { is_year = 1713 } set_variable = { which = cu_year value = 1713 } }
	else_if = { limit = { is_year = 1712 } set_variable = { which = cu_year value = 1712 } }
	else_if = { limit = { is_year = 1711 } set_variable = { which = cu_year value = 1711 } }
	else_if = { limit = { is_year = 1710 } set_variable = { which = cu_year value = 1710 } }
	else_if = { limit = { is_year = 1709 } set_variable = { which = cu_year value = 1709 } }
	else_if = { limit = { is_year = 1708 } set_variable = { which = cu_year value = 1708 } }
	else_if = { limit = { is_year = 1707 } set_variable = { which = cu_year value = 1707 } }
	else_if = { limit = { is_year = 1706 } set_variable = { which = cu_year value = 1706 } }
	else_if = { limit = { is_year = 1705 } set_variable = { which = cu_year value = 1705 } }
	else_if = { limit = { is_year = 1704 } set_variable = { which = cu_year value = 1704 } }
	else_if = { limit = { is_year = 1703 } set_variable = { which = cu_year value = 1703 } }
	else_if = { limit = { is_year = 1702 } set_variable = { which = cu_year value = 1702 } }
	else_if = { limit = { is_year = 1701 } set_variable = { which = cu_year value = 1701 } }
	else_if = { limit = { is_year = 1700 } set_variable = { which = cu_year value = 1700 } }
	else_if = { limit = { is_year = 1699 } set_variable = { which = cu_year value = 1699 } }
	else_if = { limit = { is_year = 1698 } set_variable = { which = cu_year value = 1698 } }
	else_if = { limit = { is_year = 1697 } set_variable = { which = cu_year value = 1697 } }
	else_if = { limit = { is_year = 1696 } set_variable = { which = cu_year value = 1696 } }
	else_if = { limit = { is_year = 1695 } set_variable = { which = cu_year value = 1695 } }
	else_if = { limit = { is_year = 1694 } set_variable = { which = cu_year value = 1694 } }
	else_if = { limit = { is_year = 1693 } set_variable = { which = cu_year value = 1693 } }
	else_if = { limit = { is_year = 1692 } set_variable = { which = cu_year value = 1692 } }
	else_if = { limit = { is_year = 1691 } set_variable = { which = cu_year value = 1691 } }
	else_if = { limit = { is_year = 1690 } set_variable = { which = cu_year value = 1690 } }
	else_if = { limit = { is_year = 1689 } set_variable = { which = cu_year value = 1689 } }
	else_if = { limit = { is_year = 1688 } set_variable = { which = cu_year value = 1688 } }
	else_if = { limit = { is_year = 1687 } set_variable = { which = cu_year value = 1687 } }
	else_if = { limit = { is_year = 1686 } set_variable = { which = cu_year value = 1686 } }
	else_if = { limit = { is_year = 1685 } set_variable = { which = cu_year value = 1685 } }
	else_if = { limit = { is_year = 1684 } set_variable = { which = cu_year value = 1684 } }
	else_if = { limit = { is_year = 1683 } set_variable = { which = cu_year value = 1683 } }
	else_if = { limit = { is_year = 1682 } set_variable = { which = cu_year value = 1682 } }
	else_if = { limit = { is_year = 1681 } set_variable = { which = cu_year value = 1681 } }
	else_if = { limit = { is_year = 1680 } set_variable = { which = cu_year value = 1680 } }
	else_if = { limit = { is_year = 1679 } set_variable = { which = cu_year value = 1679 } }
	else_if = { limit = { is_year = 1678 } set_variable = { which = cu_year value = 1678 } }
	else_if = { limit = { is_year = 1677 } set_variable = { which = cu_year value = 1677 } }
	else_if = { limit = { is_year = 1676 } set_variable = { which = cu_year value = 1676 } }
	else_if = { limit = { is_year = 1675 } set_variable = { which = cu_year value = 1675 } }
	else_if = { limit = { is_year = 1674 } set_variable = { which = cu_year value = 1674 } }
	else_if = { limit = { is_year = 1673 } set_variable = { which = cu_year value = 1673 } }
	else_if = { limit = { is_year = 1672 } set_variable = { which = cu_year value = 1672 } }
	else_if = { limit = { is_year = 1671 } set_variable = { which = cu_year value = 1671 } }
	else_if = { limit = { is_year = 1670 } set_variable = { which = cu_year value = 1670 } }
	else_if = { limit = { is_year = 1669 } set_variable = { which = cu_year value = 1669 } }
	else_if = { limit = { is_year = 1668 } set_variable = { which = cu_year value = 1668 } }
	else_if = { limit = { is_year = 1667 } set_variable = { which = cu_year value = 1667 } }
	else_if = { limit = { is_year = 1666 } set_variable = { which = cu_year value = 1666 } }
	else_if = { limit = { is_year = 1665 } set_variable = { which = cu_year value = 1665 } }
	else_if = { limit = { is_year = 1664 } set_variable = { which = cu_year value = 1664 } }
	else_if = { limit = { is_year = 1663 } set_variable = { which = cu_year value = 1663 } }
	else_if = { limit = { is_year = 1662 } set_variable = { which = cu_year value = 1662 } }
	else_if = { limit = { is_year = 1661 } set_variable = { which = cu_year value = 1661 } }
	else_if = { limit = { is_year = 1660 } set_variable = { which = cu_year value = 1660 } }
	else_if = { limit = { is_year = 1659 } set_variable = { which = cu_year value = 1659 } }
	else_if = { limit = { is_year = 1658 } set_variable = { which = cu_year value = 1658 } }
	else_if = { limit = { is_year = 1657 } set_variable = { which = cu_year value = 1657 } }
	else_if = { limit = { is_year = 1656 } set_variable = { which = cu_year value = 1656 } }
	else_if = { limit = { is_year = 1655 } set_variable = { which = cu_year value = 1655 } }
	else_if = { limit = { is_year = 1654 } set_variable = { which = cu_year value = 1654 } }
	else_if = { limit = { is_year = 1653 } set_variable = { which = cu_year value = 1653 } }
	else_if = { limit = { is_year = 1652 } set_variable = { which = cu_year value = 1652 } }
	else_if = { limit = { is_year = 1651 } set_variable = { which = cu_year value = 1651 } }
	else_if = { limit = { is_year = 1650 } set_variable = { which = cu_year value = 1650 } }
	else_if = { limit = { is_year = 1649 } set_variable = { which = cu_year value = 1649 } }
	else_if = { limit = { is_year = 1648 } set_variable = { which = cu_year value = 1648 } }
	else_if = { limit = { is_year = 1647 } set_variable = { which = cu_year value = 1647 } }
	else_if = { limit = { is_year = 1646 } set_variable = { which = cu_year value = 1646 } }
	else_if = { limit = { is_year = 1645 } set_variable = { which = cu_year value = 1645 } }
	else_if = { limit = { is_year = 1644 } set_variable = { which = cu_year value = 1644 } }
	else_if = { limit = { is_year = 1643 } set_variable = { which = cu_year value = 1643 } }
	else_if = { limit = { is_year = 1642 } set_variable = { which = cu_year value = 1642 } }
	else_if = { limit = { is_year = 1641 } set_variable = { which = cu_year value = 1641 } }
	else_if = { limit = { is_year = 1640 } set_variable = { which = cu_year value = 1640 } }
	else_if = { limit = { is_year = 1639 } set_variable = { which = cu_year value = 1639 } }
	else_if = { limit = { is_year = 1638 } set_variable = { which = cu_year value = 1638 } }
	else_if = { limit = { is_year = 1637 } set_variable = { which = cu_year value = 1637 } }
	else_if = { limit = { is_year = 1636 } set_variable = { which = cu_year value = 1636 } }
	else_if = { limit = { is_year = 1635 } set_variable = { which = cu_year value = 1635 } }
	else_if = { limit = { is_year = 1634 } set_variable = { which = cu_year value = 1634 } }
	else_if = { limit = { is_year = 1633 } set_variable = { which = cu_year value = 1633 } }
	else_if = { limit = { is_year = 1632 } set_variable = { which = cu_year value = 1632 } }
	else_if = { limit = { is_year = 1631 } set_variable = { which = cu_year value = 1631 } }
	else_if = { limit = { is_year = 1630 } set_variable = { which = cu_year value = 1630 } }
	else_if = { limit = { is_year = 1629 } set_variable = { which = cu_year value = 1629 } }
	else_if = { limit = { is_year = 1628 } set_variable = { which = cu_year value = 1628 } }
	else_if = { limit = { is_year = 1627 } set_variable = { which = cu_year value = 1627 } }
	else_if = { limit = { is_year = 1626 } set_variable = { which = cu_year value = 1626 } }
	else_if = { limit = { is_year = 1625 } set_variable = { which = cu_year value = 1625 } }
	else_if = { limit = { is_year = 1624 } set_variable = { which = cu_year value = 1624 } }
	else_if = { limit = { is_year = 1623 } set_variable = { which = cu_year value = 1623 } }
	else_if = { limit = { is_year = 1622 } set_variable = { which = cu_year value = 1622 } }
	else_if = { limit = { is_year = 1621 } set_variable = { which = cu_year value = 1621 } }
	else_if = { limit = { is_year = 1620 } set_variable = { which = cu_year value = 1620 } }
	else_if = { limit = { is_year = 1619 } set_variable = { which = cu_year value = 1619 } }
	else_if = { limit = { is_year = 1618 } set_variable = { which = cu_year value = 1618 } }
	else_if = { limit = { is_year = 1617 } set_variable = { which = cu_year value = 1617 } }
	else_if = { limit = { is_year = 1616 } set_variable = { which = cu_year value = 1616 } }
	else_if = { limit = { is_year = 1615 } set_variable = { which = cu_year value = 1615 } }
	else_if = { limit = { is_year = 1614 } set_variable = { which = cu_year value = 1614 } }
	else_if = { limit = { is_year = 1613 } set_variable = { which = cu_year value = 1613 } }
	else_if = { limit = { is_year = 1612 } set_variable = { which = cu_year value = 1612 } }
	else_if = { limit = { is_year = 1611 } set_variable = { which = cu_year value = 1611 } }
	else_if = { limit = { is_year = 1610 } set_variable = { which = cu_year value = 1610 } }
	else_if = { limit = { is_year = 1609 } set_variable = { which = cu_year value = 1609 } }
	else_if = { limit = { is_year = 1608 } set_variable = { which = cu_year value = 1608 } }
	else_if = { limit = { is_year = 1607 } set_variable = { which = cu_year value = 1607 } }
	else_if = { limit = { is_year = 1606 } set_variable = { which = cu_year value = 1606 } }
	else_if = { limit = { is_year = 1605 } set_variable = { which = cu_year value = 1605 } }
	else_if = { limit = { is_year = 1604 } set_variable = { which = cu_year value = 1604 } }
	else_if = { limit = { is_year = 1603 } set_variable = { which = cu_year value = 1603 } }
	else_if = { limit = { is_year = 1602 } set_variable = { which = cu_year value = 1602 } }
	else_if = { limit = { is_year = 1601 } set_variable = { which = cu_year value = 1601 } }
	else_if = { limit = { is_year = 1600 } set_variable = { which = cu_year value = 1600 } }
	else_if = { limit = { is_year = 1599 } set_variable = { which = cu_year value = 1599 } }
	else_if = { limit = { is_year = 1598 } set_variable = { which = cu_year value = 1598 } }
	else_if = { limit = { is_year = 1597 } set_variable = { which = cu_year value = 1597 } }
	else_if = { limit = { is_year = 1596 } set_variable = { which = cu_year value = 1596 } }
	else_if = { limit = { is_year = 1595 } set_variable = { which = cu_year value = 1595 } }
	else_if = { limit = { is_year = 1594 } set_variable = { which = cu_year value = 1594 } }
	else_if = { limit = { is_year = 1593 } set_variable = { which = cu_year value = 1593 } }
	else_if = { limit = { is_year = 1592 } set_variable = { which = cu_year value = 1592 } }
	else_if = { limit = { is_year = 1591 } set_variable = { which = cu_year value = 1591 } }
	else_if = { limit = { is_year = 1590 } set_variable = { which = cu_year value = 1590 } }
	else_if = { limit = { is_year = 1589 } set_variable = { which = cu_year value = 1589 } }
	else_if = { limit = { is_year = 1588 } set_variable = { which = cu_year value = 1588 } }
	else_if = { limit = { is_year = 1587 } set_variable = { which = cu_year value = 1587 } }
	else_if = { limit = { is_year = 1586 } set_variable = { which = cu_year value = 1586 } }
	else_if = { limit = { is_year = 1585 } set_variable = { which = cu_year value = 1585 } }
	else_if = { limit = { is_year = 1584 } set_variable = { which = cu_year value = 1584 } }
	else_if = { limit = { is_year = 1583 } set_variable = { which = cu_year value = 1583 } }
	else_if = { limit = { is_year = 1582 } set_variable = { which = cu_year value = 1582 } }
	else_if = { limit = { is_year = 1581 } set_variable = { which = cu_year value = 1581 } }
	else_if = { limit = { is_year = 1580 } set_variable = { which = cu_year value = 1580 } }
	else_if = { limit = { is_year = 1579 } set_variable = { which = cu_year value = 1579 } }
	else_if = { limit = { is_year = 1578 } set_variable = { which = cu_year value = 1578 } }
	else_if = { limit = { is_year = 1577 } set_variable = { which = cu_year value = 1577 } }
	else_if = { limit = { is_year = 1576 } set_variable = { which = cu_year value = 1576 } }
	else_if = { limit = { is_year = 1575 } set_variable = { which = cu_year value = 1575 } }
	else_if = { limit = { is_year = 1574 } set_variable = { which = cu_year value = 1574 } }
	else_if = { limit = { is_year = 1573 } set_variable = { which = cu_year value = 1573 } }
	else_if = { limit = { is_year = 1572 } set_variable = { which = cu_year value = 1572 } }
	else_if = { limit = { is_year = 1571 } set_variable = { which = cu_year value = 1571 } }
	else_if = { limit = { is_year = 1570 } set_variable = { which = cu_year value = 1570 } }
	else_if = { limit = { is_year = 1569 } set_variable = { which = cu_year value = 1569 } }
	else_if = { limit = { is_year = 1568 } set_variable = { which = cu_year value = 1568 } }
	else_if = { limit = { is_year = 1567 } set_variable = { which = cu_year value = 1567 } }
	else_if = { limit = { is_year = 1566 } set_variable = { which = cu_year value = 1566 } }
	else_if = { limit = { is_year = 1565 } set_variable = { which = cu_year value = 1565 } }
	else_if = { limit = { is_year = 1564 } set_variable = { which = cu_year value = 1564 } }
	else_if = { limit = { is_year = 1563 } set_variable = { which = cu_year value = 1563 } }
	else_if = { limit = { is_year = 1562 } set_variable = { which = cu_year value = 1562 } }
	else_if = { limit = { is_year = 1561 } set_variable = { which = cu_year value = 1561 } }
	else_if = { limit = { is_year = 1560 } set_variable = { which = cu_year value = 1560 } }
	else_if = { limit = { is_year = 1559 } set_variable = { which = cu_year value = 1559 } }
	else_if = { limit = { is_year = 1558 } set_variable = { which = cu_year value = 1558 } }
	else_if = { limit = { is_year = 1557 } set_variable = { which = cu_year value = 1557 } }
	else_if = { limit = { is_year = 1556 } set_variable = { which = cu_year value = 1556 } }
	else_if = { limit = { is_year = 1555 } set_variable = { which = cu_year value = 1555 } }
	else_if = { limit = { is_year = 1554 } set_variable = { which = cu_year value = 1554 } }
	else_if = { limit = { is_year = 1553 } set_variable = { which = cu_year value = 1553 } }
	else_if = { limit = { is_year = 1552 } set_variable = { which = cu_year value = 1552 } }
	else_if = { limit = { is_year = 1551 } set_variable = { which = cu_year value = 1551 } }
	else_if = { limit = { is_year = 1550 } set_variable = { which = cu_year value = 1550 } }
	else_if = { limit = { is_year = 1549 } set_variable = { which = cu_year value = 1549 } }
	else_if = { limit = { is_year = 1548 } set_variable = { which = cu_year value = 1548 } }
	else_if = { limit = { is_year = 1547 } set_variable = { which = cu_year value = 1547 } }
	else_if = { limit = { is_year = 1546 } set_variable = { which = cu_year value = 1546 } }
	else_if = { limit = { is_year = 1545 } set_variable = { which = cu_year value = 1545 } }
	else_if = { limit = { is_year = 1544 } set_variable = { which = cu_year value = 1544 } }
	else_if = { limit = { is_year = 1543 } set_variable = { which = cu_year value = 1543 } }
	else_if = { limit = { is_year = 1542 } set_variable = { which = cu_year value = 1542 } }
	else_if = { limit = { is_year = 1541 } set_variable = { which = cu_year value = 1541 } }
	else_if = { limit = { is_year = 1540 } set_variable = { which = cu_year value = 1540 } }
	else_if = { limit = { is_year = 1539 } set_variable = { which = cu_year value = 1539 } }
	else_if = { limit = { is_year = 1538 } set_variable = { which = cu_year value = 1538 } }
	else_if = { limit = { is_year = 1537 } set_variable = { which = cu_year value = 1537 } }
	else_if = { limit = { is_year = 1536 } set_variable = { which = cu_year value = 1536 } }
	else_if = { limit = { is_year = 1535 } set_variable = { which = cu_year value = 1535 } }
	else_if = { limit = { is_year = 1534 } set_variable = { which = cu_year value = 1534 } }
	else_if = { limit = { is_year = 1533 } set_variable = { which = cu_year value = 1533 } }
	else_if = { limit = { is_year = 1532 } set_variable = { which = cu_year value = 1532 } }
	else_if = { limit = { is_year = 1531 } set_variable = { which = cu_year value = 1531 } }
	else_if = { limit = { is_year = 1530 } set_variable = { which = cu_year value = 1530 } }
	else_if = { limit = { is_year = 1529 } set_variable = { which = cu_year value = 1529 } }
	else_if = { limit = { is_year = 1528 } set_variable = { which = cu_year value = 1528 } }
	else_if = { limit = { is_year = 1527 } set_variable = { which = cu_year value = 1527 } }
	else_if = { limit = { is_year = 1526 } set_variable = { which = cu_year value = 1526 } }
	else_if = { limit = { is_year = 1525 } set_variable = { which = cu_year value = 1525 } }
	else_if = { limit = { is_year = 1524 } set_variable = { which = cu_year value = 1524 } }
	else_if = { limit = { is_year = 1523 } set_variable = { which = cu_year value = 1523 } }
	else_if = { limit = { is_year = 1522 } set_variable = { which = cu_year value = 1522 } }
	else_if = { limit = { is_year = 1521 } set_variable = { which = cu_year value = 1521 } }
	else_if = { limit = { is_year = 1520 } set_variable = { which = cu_year value = 1520 } }
	else_if = { limit = { is_year = 1519 } set_variable = { which = cu_year value = 1519 } }
	else_if = { limit = { is_year = 1518 } set_variable = { which = cu_year value = 1518 } }
	else_if = { limit = { is_year = 1517 } set_variable = { which = cu_year value = 1517 } }
	else_if = { limit = { is_year = 1516 } set_variable = { which = cu_year value = 1516 } }
	else_if = { limit = { is_year = 1515 } set_variable = { which = cu_year value = 1515 } }
	else_if = { limit = { is_year = 1514 } set_variable = { which = cu_year value = 1514 } }
	else_if = { limit = { is_year = 1513 } set_variable = { which = cu_year value = 1513 } }
	else_if = { limit = { is_year = 1512 } set_variable = { which = cu_year value = 1512 } }
	else_if = { limit = { is_year = 1511 } set_variable = { which = cu_year value = 1511 } }
	else_if = { limit = { is_year = 1510 } set_variable = { which = cu_year value = 1510 } }
	else_if = { limit = { is_year = 1509 } set_variable = { which = cu_year value = 1509 } }
	else_if = { limit = { is_year = 1508 } set_variable = { which = cu_year value = 1508 } }
	else_if = { limit = { is_year = 1507 } set_variable = { which = cu_year value = 1507 } }
	else_if = { limit = { is_year = 1506 } set_variable = { which = cu_year value = 1506 } }
	else_if = { limit = { is_year = 1505 } set_variable = { which = cu_year value = 1505 } }
	else_if = { limit = { is_year = 1504 } set_variable = { which = cu_year value = 1504 } }
	else_if = { limit = { is_year = 1503 } set_variable = { which = cu_year value = 1503 } }
	else_if = { limit = { is_year = 1502 } set_variable = { which = cu_year value = 1502 } }
	else_if = { limit = { is_year = 1501 } set_variable = { which = cu_year value = 1501 } }
	else_if = { limit = { is_year = 1500 } set_variable = { which = cu_year value = 1500 } }
	else_if = { limit = { is_year = 1499 } set_variable = { which = cu_year value = 1499 } }
	else_if = { limit = { is_year = 1498 } set_variable = { which = cu_year value = 1498 } }
	else_if = { limit = { is_year = 1497 } set_variable = { which = cu_year value = 1497 } }
	else_if = { limit = { is_year = 1496 } set_variable = { which = cu_year value = 1496 } }
	else_if = { limit = { is_year = 1495 } set_variable = { which = cu_year value = 1495 } }
	else_if = { limit = { is_year = 1494 } set_variable = { which = cu_year value = 1494 } }
	else_if = { limit = { is_year = 1493 } set_variable = { which = cu_year value = 1493 } }
	else_if = { limit = { is_year = 1492 } set_variable = { which = cu_year value = 1492 } }
	else_if = { limit = { is_year = 1491 } set_variable = { which = cu_year value = 1491 } }
	else_if = { limit = { is_year = 1490 } set_variable = { which = cu_year value = 1490 } }
	else_if = { limit = { is_year = 1489 } set_variable = { which = cu_year value = 1489 } }
	else_if = { limit = { is_year = 1488 } set_variable = { which = cu_year value = 1488 } }
	else_if = { limit = { is_year = 1487 } set_variable = { which = cu_year value = 1487 } }
	else_if = { limit = { is_year = 1486 } set_variable = { which = cu_year value = 1486 } }
	else_if = { limit = { is_year = 1485 } set_variable = { which = cu_year value = 1485 } }
	else_if = { limit = { is_year = 1484 } set_variable = { which = cu_year value = 1484 } }
	else_if = { limit = { is_year = 1483 } set_variable = { which = cu_year value = 1483 } }
	else_if = { limit = { is_year = 1482 } set_variable = { which = cu_year value = 1482 } }
	else_if = { limit = { is_year = 1481 } set_variable = { which = cu_year value = 1481 } }
	else_if = { limit = { is_year = 1480 } set_variable = { which = cu_year value = 1480 } }
	else_if = { limit = { is_year = 1479 } set_variable = { which = cu_year value = 1479 } }
	else_if = { limit = { is_year = 1478 } set_variable = { which = cu_year value = 1478 } }
	else_if = { limit = { is_year = 1477 } set_variable = { which = cu_year value = 1477 } }
	else_if = { limit = { is_year = 1476 } set_variable = { which = cu_year value = 1476 } }
	else_if = { limit = { is_year = 1475 } set_variable = { which = cu_year value = 1475 } }
	else_if = { limit = { is_year = 1474 } set_variable = { which = cu_year value = 1474 } }
	else_if = { limit = { is_year = 1473 } set_variable = { which = cu_year value = 1473 } }
	else_if = { limit = { is_year = 1472 } set_variable = { which = cu_year value = 1472 } }
	else_if = { limit = { is_year = 1471 } set_variable = { which = cu_year value = 1471 } }
	else_if = { limit = { is_year = 1470 } set_variable = { which = cu_year value = 1470 } }
	else_if = { limit = { is_year = 1469 } set_variable = { which = cu_year value = 1469 } }
	else_if = { limit = { is_year = 1468 } set_variable = { which = cu_year value = 1468 } }
	else_if = { limit = { is_year = 1467 } set_variable = { which = cu_year value = 1467 } }
	else_if = { limit = { is_year = 1466 } set_variable = { which = cu_year value = 1466 } }
	else_if = { limit = { is_year = 1465 } set_variable = { which = cu_year value = 1465 } }
	else_if = { limit = { is_year = 1464 } set_variable = { which = cu_year value = 1464 } }
	else_if = { limit = { is_year = 1463 } set_variable = { which = cu_year value = 1463 } }
	else_if = { limit = { is_year = 1462 } set_variable = { which = cu_year value = 1462 } }
	else_if = { limit = { is_year = 1461 } set_variable = { which = cu_year value = 1461 } }
	else_if = { limit = { is_year = 1460 } set_variable = { which = cu_year value = 1460 } }
	else_if = { limit = { is_year = 1459 } set_variable = { which = cu_year value = 1459 } }
	else_if = { limit = { is_year = 1458 } set_variable = { which = cu_year value = 1458 } }
	else_if = { limit = { is_year = 1457 } set_variable = { which = cu_year value = 1457 } }
	else_if = { limit = { is_year = 1456 } set_variable = { which = cu_year value = 1456 } }
	else_if = { limit = { is_year = 1455 } set_variable = { which = cu_year value = 1455 } }
	else_if = { limit = { is_year = 1454 } set_variable = { which = cu_year value = 1454 } }
	else_if = { limit = { is_year = 1453 } set_variable = { which = cu_year value = 1453 } }
	else_if = { limit = { is_year = 1452 } set_variable = { which = cu_year value = 1452 } }
	else_if = { limit = { is_year = 1451 } set_variable = { which = cu_year value = 1451 } }
	else_if = { limit = { is_year = 1450 } set_variable = { which = cu_year value = 1450 } }
	else_if = { limit = { is_year = 1449 } set_variable = { which = cu_year value = 1449 } }
	else_if = { limit = { is_year = 1448 } set_variable = { which = cu_year value = 1448 } }
	else_if = { limit = { is_year = 1447 } set_variable = { which = cu_year value = 1447 } }
	else_if = { limit = { is_year = 1446 } set_variable = { which = cu_year value = 1446 } }
	else_if = { limit = { is_year = 1445 } set_variable = { which = cu_year value = 1445 } }
	else_if = { limit = { is_year = 1444 } set_variable = { which = cu_year value = 1444 } }
}

cu_correct_year = {
    1 = {
		if = {
			limit = { NOT = { check_variable = { which = cu_year value = 1444 } } }
			cu_initial_year = yes
		}
		PREV = { set_variable = { which = cu_year which = PREV } }
	}
}

cu_export_s_dev = {
	set_variable = { which = s_dev value = 0 }
	export_to_variable = {
		which = s_dev
		value = states_development
	}
}


cu_gov_effect = {
	every_owned_province = {
	
		if = {
			limit = {
				owner = { has_reform = universal_suffrage }
				has_seat_in_parliament = no
				is_state_core = owner
				cu_not_terr_trigger = yes
			}
			set_seat_in_parliament = yes
		}
		
		if = {
			limit = {
				owner = { has_reform = burghers_election }
				cu_not_terr_trigger = yes
			}
			add_province_modifier = cu_seat_maintenance_modifier_1
		}

		if = {
			limit = {
				owner = { has_reform = universal_suffrage }
				cu_not_terr_trigger = yes
			}
			add_province_modifier = cu_seat_maintenance_modifier_2
		}

	}
}


cu_register_ruler = {
    if = { 
		limit = {
			NOT = { has_country_flag = regent_ruler }
		}
        if = {
		     limit = { adm = 6 }
		     set_variable = { which = cu_ruler_adm value = 6 }
		}
        else_if = {
		     limit = { adm = 5 }
		     set_variable = { which = cu_ruler_adm value = 5 }
		}
        else_if = {
		     limit = { adm = 4 }
		     set_variable = { which = cu_ruler_adm value = 4 }
		}
        else_if = {
		     limit = { adm = 3 }
		     set_variable = { which = cu_ruler_adm value = 3 }
		}	
		else_if = {
		     limit = { adm = 2 }
		     set_variable = { which = cu_ruler_adm value = 2 }
		}
        else_if = {
		     limit = { adm = 1 }
		     set_variable = { which = cu_ruler_adm value = 1 }
		}
        else = {
		     set_variable = { which = cu_ruler_adm value = 0 }
		}
        if = {
		     limit = { dip = 6 }
		     set_variable = { which = cu_ruler_dip value = 6 }
		}
        else_if = {
		     limit = { dip = 5 }
		     set_variable = { which = cu_ruler_dip value = 5 }
		}
        else_if = {
		     limit = { dip = 4 }
		     set_variable = { which = cu_ruler_dip value = 4 }
		}
        else_if = {
		     limit = { dip = 3 }
		     set_variable = { which = cu_ruler_dip value = 3 }
		}	
		else_if = {
		     limit = { dip = 2 }
		     set_variable = { which = cu_ruler_dip value = 2 }
		}
        else_if = {
		     limit = { dip = 1 }
		     set_variable = { which = cu_ruler_dip value = 1 }
		}
        else = {
		     set_variable = { which = cu_ruler_dip value = 0 }
		}
		if = {
		     limit = { mil = 6 }
		     set_variable = { which = cu_ruler_mil value = 6 }
		}
        else_if = {
		     limit = { mil = 5 }
		     set_variable = { which = cu_ruler_mil value = 5 }
		}
        else_if = {
		     limit = { mil = 4 }
		     set_variable = { which = cu_ruler_mil value = 4 }
		}
        else_if = {
		     limit = { mil = 3 }
		     set_variable = { which = cu_ruler_mil value = 3 }
		}	
		else_if = {
		     limit = { mil = 2 }
		     set_variable = { which = cu_ruler_mil value = 2 }
		}
        else_if = {
		     limit = { mil = 1 }
		     set_variable = { which = cu_ruler_mil value = 1 }
		}
        else = {
		     set_variable = { which = cu_ruler_mil value = 0 }
		}
		set_variable = { which = cu_ruler_power which = cu_ruler_adm }
		change_variable = { which = cu_ruler_power which = cu_ruler_dip }
		change_variable = { which = cu_ruler_power which = cu_ruler_mil }
		if = {
		       limit = { check_variable = { which = cu_year value = 1444 } }
			   set_variable = { which = cu_ruler_year which = cu_year }
		}
		else = {
			   cu_correct_year = yes
			   set_variable = { which = cu_ruler_year which = cu_year }
		}
		set_variable = { which = cu_ruler_disyear value = 0 }
		set_variable = { which = cu_ruler_warw value = 0 }
		set_variable = { which = cu_ruler_warl value = 0 }
		export_to_variable = {
		       which = cu_ruler_dev
			   value = total_development
		}
		set_variable = { which = cu_ruler_pop which = t_pop }
	}
}

cu_calc_ruler_power_reduction = {
	export_to_variable = {
	    which = cu_ruler_pm
		value = trigger_value:absolutism
	}
	multiply_variable = { which = cu_ruler_pm value = -0.7 }
	change_variable = { which = cu_ruler_pm value = 70 }
	set_variable = { which = cu_power_adm which = cu_ruler_adm }
	multiply_variable = { which = cu_power_adm which = cu_ruler_pm }
	divide_variable = { which = cu_power_adm value = 100 }
	multiply_variable = { which = cu_power_adm value = 12 }
	set_variable = { which = cu_power_dip which = cu_ruler_dip }
	multiply_variable = { which = cu_power_dip which = cu_ruler_pm }
	divide_variable = { which = cu_power_dip value = 100 }
	multiply_variable = { which = cu_power_dip value = 12 }
	set_variable = { which = cu_power_mil which = cu_ruler_mil }
	multiply_variable = { which = cu_power_mil which = cu_ruler_pm }
	divide_variable = { which = cu_power_mil value = 100 }
	multiply_variable = { which = cu_power_mil value = 12 }
	set_variable = { which = cu_ruler_pmr value = 100 }
	subtract_variable = { which = cu_ruler_pmr which = cu_ruler_pm }
} 

cu_do_ruler_power_reduction = {
	cu_calc_ruler_power_reduction = yes
    if = {
	      limit = { ai = yes }
		  multiply_variable = { which = cu_power_adm value = 5 }
		  multiply_variable = { which = cu_power_dip value = 5 }
		  multiply_variable = { which = cu_power_mil value = 5 }
	}
    set_variable = { which = cu_power which = cu_power_adm }
	cu_subtract_adm_power = yes
	set_variable = { which = cu_power which = cu_power_dip }
	cu_subtract_dip_power = yes
	set_variable = { which = cu_power which = cu_power_mil }
	cu_subtract_mil_power = yes
	if = {
	      limit = { ai = yes }
		  divide_variable = { which = cu_power_adm value = 5 }
		  divide_variable = { which = cu_power_dip value = 5 }
		  divide_variable = { which = cu_power_mil value = 5 }
	}
}

cu_random_adm_advisor = {
				custom_tooltip = cu_expert_advisor_adm_tt
				hidden_effect = {
					   cu_random_number = yes
					   if = {
							limit = { check_variable = { which = cu_rd value = 86 } }
							set_country_flag = adv_phi
					   }
					   else_if = {
							limit = { check_variable = { which = cu_rd value = 72 } }
							set_country_flag = adv_nat
					   }
					   else_if = {
							limit = { check_variable = { which = cu_rd value = 58 } }
							set_country_flag = adv_art
					   }
					   else_if = {
							limit = { check_variable = { which = cu_rd value = 44 } }
							set_country_flag = adv_tre
					   }
					   else_if = {
							limit = { check_variable = { which = cu_rd value = 30 } }
							set_country_flag = adv_the
					   }
					   else_if = {
							limit = { check_variable = { which = cu_rd value = 15 } }
							set_country_flag = adv_mas
					   }
					   else = {
							set_country_flag = adv_inq
					   }
				    
				    country_event = { id = state.7 }
				   }
}

cu_random_dip_advisor = {
			custom_tooltip = cu_expert_advisor_dip_tt
			hidden_effect = {
                   if = {
                      limit = { num_of_colonists = 1 }
					  hidden_effect = {
						   cu_random_number = yes
						   if = {
								limit = { check_variable = { which = cu_rd value = 86 } }
								set_country_flag = adv_sta
						   }
						   else_if = {
								limit = { check_variable = { which = cu_rd value = 72 } }
								set_country_flag = adv_nav
						   }
						   else_if = {
								limit = { check_variable = { which = cu_rd value = 58 } }
								set_country_flag = adv_col
						   }
						   else_if = {
								limit = { check_variable = { which = cu_rd value = 44 } }
								set_country_flag = adv_nvg
						   }
						   else_if = {
								limit = { check_variable = { which = cu_rd value = 30 } }
								set_country_flag = adv_tra
						   }
						   else_if = {
								limit = { check_variable = { which = cu_rd value = 15 } }
								set_country_flag = adv_spy
						   }
						   else = {
								set_country_flag = adv_dip
						   }
				     }
                  }
				  else = {
					  hidden_effect = {
						   cu_random_number = yes
						   if = {
								limit = { check_variable = { which = cu_rd value = 80 } }
								set_country_flag = adv_sta
						   }
						   else_if = {
								limit = { check_variable = { which = cu_rd value = 60 } }
								set_country_flag = adv_tra
						   }
						   else_if = {
								limit = { check_variable = { which = cu_rd value = 40 } }
								set_country_flag = adv_spy
						   }
						   else_if = {
								limit = { check_variable = { which = cu_rd value = 20 } }
								set_country_flag = adv_nav
						   }
						   else = {
								set_country_flag = adv_dip
						   }
				     }
				  }
				  country_event = { id = state.7 }
			}
}

cu_random_mil_advisor = {
				custom_tooltip = cu_expert_advisor_adm_tt
                   hidden_effect = {
							cu_random_number = yes
						   if = {
								limit = { check_variable = { which = cu_rd value = 84 } }
								set_country_flag = adv_arm
						   }
						   else_if = {
								limit = { check_variable = { which = cu_rd value = 68 } }
								set_country_flag = adv_org
						   }
						   else_if = {
								limit = { check_variable = { which = cu_rd value = 51 } }
								set_country_flag = adv_com
						   }
						   else_if = {
								limit = { check_variable = { which = cu_rd value = 35 } }
								set_country_flag = adv_qua
						   }
						   else_if = {
								limit = { check_variable = { which = cu_rd value = 17 } }
								set_country_flag = adv_rec
						   }
						   else = {
								set_country_flag = adv_for
						   }
							country_event = { id = state.7 }
				  }
}

cu_subtract_development_1 = {
					if = {
						limit = { 
							base_tax = 2
							base_production = 2
							base_manpower = 2
						}
						cu_random_number = yes
						if = {
							limit = { check_variable = { which = cu_rd value = 66 } }
							add_base_tax = -1
						}
						else_if = {
							limit = { check_variable = { which = cu_rd value = 33 } }
							add_base_production = -1
						}
						else = {
							add_base_manpower = -1
						}
					}
					else_if = {
						limit = { 
						    base_tax = 2
							base_production = 2 
						}
						cu_random_number = yes
						if = {
							limit = { check_variable = { which = cu_rd value = 50 } }
							add_base_tax = -1
						}
						else = {
							add_base_production = -1
						}
					}
					else_if = {
						limit = { 
						    base_tax = 2
							base_manpower = 2 
						}
						cu_random_number = yes
						if = {
							limit = { check_variable = { which = cu_rd value = 50 } }
							add_base_tax = -1
						}
						else = {
							add_base_manpower = -1
						}
					}
					else_if = {
						limit = { 
						    base_production = 2 
							base_manpower = 2 
						}
						cu_random_number = yes
						if = {
							limit = { check_variable = { which = cu_rd value = 50 } }
							add_base_production = -1
						}
						else = {
							add_base_manpower = -1
						}
					}
					else_if = {
						limit = {
							base_tax = 2
						}
						add_base_tax = -1
					}
					else_if = {
						limit = {
							base_production = 2
						}
						add_base_production = -1
					}
					else_if = {
						limit = { base_manpower = 2 }
						add_base_manpower = -1
					}
}

cu_do_starvation = {
					if = {
						limit = { 
						    base_tax = 2
							base_production = 2 
						}
						cu_random_number = yes
						if = {
							limit = { check_variable = { which = cu_rd value = 50 } }
							add_base_tax = -1
						}
						else = {
							add_base_production = -1
						}
					}
					
					else_if = {
						limit = {
							base_tax = 2
						}
						add_base_tax = -1
					}
					else_if = {
						limit = {
							base_production = 2
						}
						add_base_production = -1
					}
					else_if = {
						limit = { base_manpower = 2 }
						add_base_manpower = -1
					}
}

cu_do_prov_loot = {
	#cu_random_number = yes
	if = {
		limit = { check_variable = { which = cu_rd value = 85 } }
		custom_tooltip = cu_prov_emmigration_tt
		hidden_effect = {
			province_event = { id = pop.01 }
		}
	}
	else_if = {
		limit = { check_variable = { which = pop_growth value = 0 } }
		custom_tooltip = cu_subtract_development_1_tt
		hidden_effect = {
			cu_subtract_development_1 = yes
		}
	}
	else = {
		custom_tooltip = cu_do_starvation_tt
		hidden_effect = {
			cu_do_starvation = yes
		}
	}
}

#Road Effects

cu_update_road_level = {
	set_province_flag = cu_road_calculating
	if = {
		limit = { check_variable = { which = cu_road_level which = cu_road_level_allowed } }
		set_variable = { which = cu_road_level which = cu_road_level_allowed }
	}
	remove_building = road_1
	remove_building = road_2
	remove_building = road_3
	remove_building = road_4
	remove_building = road_5
	remove_building = road_6
	remove_building = road_7
	remove_building = road_8
	remove_building = road_9
	remove_building = road_10
	if = {
		limit = { check_variable = { which = cu_road_level value = 10 } }
		add_building = road_10
	}
	else_if = {
		limit = { check_variable = { which = cu_road_level value = 9 } }
		add_building = road_9
	}
	else_if = {
		limit = { check_variable = { which = cu_road_level value = 8 } }
		add_building = road_8
	}
	else_if = {
		limit = { check_variable = { which = cu_road_level value = 7 } }
		add_building = road_7
	}
	else_if = {
		limit = { check_variable = { which = cu_road_level value = 6 } }
		add_building = road_6
	}
	else_if = {
		limit = { check_variable = { which = cu_road_level value = 5 } }
		add_building = road_5
	}
	else_if = {
		limit = { check_variable = { which = cu_road_level value = 4 } }
		add_building = road_4
	}
	else_if = {
		limit = { check_variable = { which = cu_road_level value = 3 } }
		add_building = road_3
	}
	else_if = {
		limit = { check_variable = { which = cu_road_level value = 2 } }
		add_building = road_2
	}
	else_if = {
		limit = { check_variable = { which = cu_road_level value = 1 } }
		add_building = road_1
	}
	clr_province_flag = cu_road_calculating
}

cu_calc_allowed_road_level = {
	set_variable = { which = cu_road_level_allowed_c which = owner }
	set_variable = { which = cu_road_level_allowed value = 0 }
	#Terrain Modifier
	if = {
		limit = {
			OR = {
				  has_terrain = woods
				  has_terrain = forest
				  
			}
		}
		change_variable = { which = cu_road_level_allowed value = -1 }
		if = {
			limit = {
				OR = {
					has_province_modifier = ti_woods_done
					has_province_modifier = ti_forest_done
				}
			}
			change_variable = { which = cu_road_level_allowed value = 1 }
		}
	}
	else_if = {
		limit = {
			OR = {
				  has_terrain = hills
				  has_terrain = highlands
				  has_terrain = marsh
				  
			}
		}
		change_variable = { which = cu_road_level_allowed value = -2 }
		if = {
			limit = {
				OR = {
					has_province_modifier = ti_marsh_done
       				has_province_modifier = holland_polders	
				}
			}
			change_variable = { which = cu_road_level_allowed value = 2 }
		}
		else_if = {
			limit = {
					has_province_modifier = ti_terrace_done
			}
			change_variable = { which = cu_road_level_allowed value = 1 }
		}
	}
	else_if = {
	    limit = {
			OR = {
				  has_terrain = jungle
				  has_terrain = desert
				  has_terrain = coastal_desert
				  has_terrain = mountain
				  has_terrain = glacier
				  
			}
		}
		change_variable = { which = cu_road_level_allowed value = -3 }
		if = {
			limit = {
				OR = {
					has_province_modifier = ti_irragation_done
					has_province_modifier = ti_terrace_done
				}
			}
			change_variable = { which = cu_road_level_allowed value = 1 }
		}
		else_if = {
			limit = {
			    has_province_modifier = ti_jungle_done
			}
			change_variable = { which = cu_road_level_allowed value = 2 }
		}
	}
	else_if = {
	    limit = {
			OR = {
				  has_terrain = jungle
				  has_terrain = desert
				  has_terrain = coastal_desert
				  has_terrain = mountain
				  has_terrain = glacier
				  
			}
		}
		change_variable = { which = cu_road_level_allowed value = -2 }
		if = {
			limit = {
				OR = {
					has_province_modifier = ti_irragation_done
					has_province_modifier = ti_terrace_done
				}
			}
			change_variable = { which = cu_road_level_allowed value = 1 }
		}
		else_if = {
			limit = {
			    has_province_modifier = ti_jungle_done
			}
			change_variable = { which = cu_road_level_allowed value = 2 }
		}
	}
	change_variable = { which = cu_road_level_allowed which = cu_road_level_allowed_c }
	#Strategic Ideas
	if = {
		limit = {
			owner = { quantity_ideas = 5 }
			NOT = { check_variable = { which = cu_road_level_allowed value = 4 } }
			NOT = { check_variable = { which = cu_road_level_allowed which = cu_road_level_allowed_c } }
		}
		change_variable = { which = cu_road_level_allowed value = 1 }
	}
	if = {
		limit = { NOT = { check_variable = { which = cu_road_level_allowed value = 0 } } }
		set_variable = { which = cu_road_level_allowed value = 0 }
	}
	else_if = {
		limit = { check_variable = { which = cu_road_level_allowed value = 10 } }
		set_variable = { which = cu_road_level_allowed value = 10 }
	}
	#If road level is above permitted level, degrade road to permitted level.
	if = {
		limit = { NOT = { check_variable = { which = cu_road_level_allowed which = cu_road_level } } }
		set_variable = { which = cu_road_level which = cu_road_level_allowed  }
		cu_update_road_level = yes
	}
}

cu_calc_allowed_road_level_country = {
	if = {
		limit = { dip_tech = 34 }
		set_variable = { which = cu_road_level_allowed_c value = 12 }
	}
	else_if = {
		limit = { dip_tech = 32 }
		set_variable = { which = cu_road_level_allowed_c value = 11 }
	}
	else_if = {
		limit = { dip_tech = 30 }
		set_variable = { which = cu_road_level_allowed_c value = 10 }
	}
	else_if = {
		limit = { dip_tech = 26 }
		set_variable = { which = cu_road_level_allowed_c value = 9 }
	}
	else_if = {
		limit = { dip_tech = 22 }
		set_variable = { which = cu_road_level_allowed_c value = 8 }
	}
	else_if = {
		limit = { dip_tech = 18 }
		set_variable = { which = cu_road_level_allowed_c value = 7 }
	}
	else_if = {
		limit = { dip_tech = 14 }
		set_variable = { which = cu_road_level_allowed_c value = 6 }
	}
	else_if = {
		limit = { dip_tech = 10 }
		set_variable = { which = cu_road_level_allowed_c value = 5 }
	}
	else_if = {
		limit = { dip_tech = 6 }
		set_variable = { which = cu_road_level_allowed_c value = 4 }
	}
	else_if = {
		limit = { dip_tech = 3 }
		set_variable = { which = cu_road_level_allowed_c value = 3 }
	}
	else_if = {
		limit = { dip_tech = 2 }
		set_variable = { which = cu_road_level_allowed_c value = 2 }
	}
	else_if = {
		limit = { dip_tech = 1 }
		set_variable = { which = cu_road_level_allowed_c value = 1 }
	}
	else = {
		set_variable = { which = cu_road_level_allowed_c value = 0 }
	}
	every_owned_province = {
		cu_calc_allowed_road_level = yes
	}
}

cu_improve_road_effect = {
		set_province_flag = cu_road_calculating
		if = {
				  limit = { NOT = { check_variable = { which = cu_road_level value = 0 } } } #In case of bug
				  set_variable = { which = cu_road_level value = 0 }
	    }
		change_variable = { which = cu_road_level value = 1 }
		if = {
			 limit = { check_variable = { which = cu_road_level value = 10 } }
			 remove_building = road_9
			 add_building = road_10
			 set_variable = { which = cu_road_level value = 10 }
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 9 } }
			 remove_building = road_8
			 add_building = road_9
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 8 } }
			 remove_building = road_7
			 add_building = road_8
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 7 } }
			 remove_building = road_6
			 add_building = road_7
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 6 } }
			 remove_building = road_5
			 add_building = road_6
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 5 } }
			 remove_building = road_4
			 add_building = road_5
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 4 } }
			 remove_building = road_3
			 add_building = road_4
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 3 } }
			 remove_building = road_2
			 add_building = road_3
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 2 } }
			 remove_building = road_1
			 add_building = road_2
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 1 } }
			 add_building = road_1
		}
		
	    cu_prov_trigger_dist_calc = yes
		clr_province_flag = cu_road_calculating
}

cu_degrade_road_effect = {
		
		set_province_flag = cu_road_calculating #Prevent from triggering road degrade event
		if = {
				  limit = { NOT = { check_variable = { which = cu_road_level value = 0 } } } #In case of bug
				  set_variable = { which = cu_road_level value = 0 }
	    }
		subtract_variable = { which = cu_road_level value = 1 }
		if = {
			 limit = { check_variable = { which = cu_road_level value = 9 } }
			 remove_building = road_10
			 add_building = road_9
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 8 } }
			 remove_building = road_9
			 add_building = road_8
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 7 } }
			 remove_building = road_8
			 add_building = road_7
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 6 } }
			 remove_building = road_7
			 add_building = road_6
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 5 } }
			 remove_building = road_6
			 add_building = road_5
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 4 } }
			 remove_building = road_5
			 add_building = road_4
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 3 } }
			 remove_building = road_4
			 add_building = road_3
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 2 } }
			 remove_building = road_3
			 add_building = road_2
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 1 } }
			 remove_building = road_2
			 add_building = road_1
		}
		else_if = {
		     limit = { check_variable = { which = cu_road_level value = 0 } }
		     remove_building = road_1
		}
		else = {
			set_variable = { which = cu_road_level value = 0 }
		}
	    cu_prov_trigger_dist_calc = yes
		clr_province_flag = cu_road_calculating
}


cu_degrade_road_effect_fast = { #Does not trigger distance calculation to greatly reduce calculation, mostly used by ai event
		set_province_flag = cu_road_calculating
		if = {
				  limit = { NOT = { check_variable = { which = cu_road_level value = 0 } } } #In case of bug
				  set_variable = { which = cu_road_level value = 0 }
	    }
		subtract_variable = { which = cu_road_level value = 1 }
		if = {
			 limit = { check_variable = { which = cu_road_level value = 9 } }
			 remove_building = road_10
			 add_building = road_9
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 8 } }
			 remove_building = road_9
			 add_building = road_8
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 7 } }
			 remove_building = road_8
			 add_building = road_7
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 6 } }
			 remove_building = road_7
			 add_building = road_6
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 5 } }
			 remove_building = road_6
			 add_building = road_5
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 4 } }
			 remove_building = road_5
			 add_building = road_4
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 3 } }
			 remove_building = road_4
			 add_building = road_3
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 2 } }
			 remove_building = road_3
			 add_building = road_2
		}
		else_if = {
			 limit = { check_variable = { which = cu_road_level value = 1 } }
			 remove_building = road_2
			 add_building = road_1
		}
		else_if = {
		     limit = { check_variable = { which = cu_road_level value = 0 } }
		     remove_building = road_1
		}
		else = {
			set_variable = { which = cu_road_level value = 0 }
		}
		clr_province_flag = cu_road_calculating
}
								  											  